{"version":3,"file":"Map.5235990b.js","sources":["../../src/assets/images/layers-outline.svg","../../src/assets/images/poi.png","../../src/assets/images/traffic.png","../../src/components/layers/DesktopLayers.vue","../../src/components/layers/MobileLayers.vue","../../src/static/index.ts","../../src/components/icons/IconComponent.vue","../../src/parameters/index.ts","../../src/components/drawer/SearchSection.vue","../../src/utils/location.util.ts","../../src/utils/features.util.ts","../../src/utils/index.ts","../../src/mixins/events.mixin.ts","../../src/mixins/detailsSection.mixin.ts","../../src/mixins/dimensions.mixin.ts","../../src/components/drawer/result-section/PointDetails.vue","../../src/components/drawer/result-section/ResultsSection.vue","../../src/components/drawer/DrawerComp.vue","../../src/components/MobileDetailsSection.vue","../../src/apis/index.ts","../../src/store/dimensions/state.ts","../../src/store/markers/state.ts","../../src/store/overlays/state.ts","../../src/store/drawers/state.ts","../../src/store/map/state.ts","../../src/store/state.ts","../../src/store/getters.ts","../../src/store/markers/actions.ts","../../src/store/dimensions/actions.ts","../../src/store/overlays/actions.ts","../../src/store/drawers/actions.ts","../../src/store/map/actions.ts","../../src/store/actions.ts","../../src/store/index.ts","../../src/components/Map.vue"],"sourcesContent":["export default \"__VITE_ASSET__4996c625__\"","export default \"__VITE_ASSET__5b4a45c9__\"","export default \"__VITE_ASSET__4ca49006__\"","<template>\r\n  <div\r\n    :style=\"layersStyle\"\r\n    class=\"map-settings o-hidden pos-absolute\"\r\n    :class=\"layersClass\"\r\n  >\r\n    <div class=\"justify-between d-flex\">\r\n      <div\r\n        v-for=\"tile of tiles\"\r\n        :key=\"tile.title\"\r\n        @click=\"store.actions.map.setMapType(tile.title)\"\r\n        class=\"pointer tile\"\r\n        :selected=\"tile.title == store.state.mapType\"\r\n      >\r\n        <img :src=\"tile.url\" />\r\n        <div class=\"text-sm\">\r\n          {{ tile.title[0].toUpperCase() + tile.title.slice(1) }}\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"d-flex justify-around poi-traffic\">\r\n      <div\r\n        class=\"pointer tile\"\r\n        :selected=\"store.state.poiLayer\"\r\n        @click=\"store.actions.map.togglePoi()\"\r\n      >\r\n        <img src=\"@/assets/images/poi.png\" />\r\n        <div class=\"text-sm\">Poi</div>\r\n      </div>\r\n      <div\r\n        class=\"pointer tile\"\r\n        :selected=\"store.state.trafficLayer\"\r\n        @click=\"store.actions.map.toggleTraffic()\"\r\n      >\r\n        <img src=\"@/assets/images/traffic.png\" />\r\n        <div class=\"text-sm\">Traffic</div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script setup lang=\"ts\">\r\nimport { Store } from \"@/store/store.model\"\r\nimport { defineProps, inject, PropType } from \"vue\"\r\nimport { Tile } from \"../Map.model\"\r\ndefineProps({\r\n  tiles: {\r\n    type: Array as PropType<Tile[]>,\r\n    default: () => [],\r\n  },\r\n  layersClass: [String, Array, Object],\r\n  layersStyle: Object,\r\n})\r\n\r\nconst store = inject<Store>(\"store\") as Store\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.map-settings {\r\n  background-color: white;\r\n  border-radius: 0.5em;\r\n  border: 1px solid rgb(142, 142, 142);\r\n  z-index: 10;\r\n  bottom: 4%;\r\n  left: 1%;\r\n  max-width: 6em;\r\n  max-height: 6em;\r\n  transition: 0.5s;\r\n  box-sizing: border-box;\r\n  &:hover {\r\n    max-width: 38em;\r\n    max-height: 100%;\r\n    transition: 1s;\r\n    border: 1px solid rgba(142, 142, 142, 0.409);\r\n  }\r\n  .tile {\r\n    text-align: center;\r\n    width: 6.5em;\r\n    transition: 0.5s;\r\n    img {\r\n      height: 6em;\r\n      width: 6em;\r\n      border-radius: 0.5em;\r\n      border: 1px solid rgba(0, 0, 0, 0);\r\n    }\r\n    &[selected=\"true\"] {\r\n      img {\r\n        border: 1px solid var(--primary);\r\n      }\r\n      color: var(--primary);\r\n    }\r\n  }\r\n  .poi-traffic {\r\n    .tile {\r\n      &:not([selected=\"true\"]) {\r\n        filter: grayscale(0.8);\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <div\r\n    v-show=\"modelValue\"\r\n    class=\"mobile-settings-container pos-absolute o-hidden\"\r\n    :class=\"layersClass\"\r\n    :style=\"layersStyle\"\r\n    @click=\"close\"\r\n  >\r\n    <div\r\n      class=\"mobile-settings pos-absolute px-1\"\r\n      :activated=\"showTiles\"\r\n      @click.prevent.stop=\"() => {}\"\r\n    >\r\n      <div class=\"map-layers d-flex justify-center\">\r\n        <div\r\n          class=\"d-flex justify-between align-center tile\"\r\n          :selected=\"store.state.poiLayer\"\r\n          @click=\"store.actions.map.togglePoi()\"\r\n        >\r\n          <img src=\"../../assets/images/poi.png\" />\r\n          <div class=\"desc text-sm\">POI</div>\r\n        </div>\r\n        <div\r\n          class=\"d-flex justify-between align-center tile\"\r\n          :selected=\"store.state.trafficLayer\"\r\n          @click=\"store.actions.map.toggleTraffic()\"\r\n        >\r\n          <img src=\"../../assets/images/traffic.png\" />\r\n          <div class=\"desc text-sm\">Traffic</div>\r\n        </div>\r\n      </div>\r\n      <div class=\"map-types d-flex justify-center\">\r\n        <div\r\n          v-for=\"tile of tiles\"\r\n          :key=\"tile.title\"\r\n          :selected=\"tile.title == store.state.mapType\"\r\n          class=\"d-flex justify-between align-center tile\"\r\n          @click=\"store.actions.map.setMapType(tile.title)\"\r\n        >\r\n          <img :src=\"tile.url\" />\r\n          <div class=\"desc text-sm\">\r\n            {{ tile.title[0].toUpperCase() + tile.title.slice(1) }}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script setup lang=\"ts\">\r\nimport { inject, ref } from \"vue\"\r\nimport { Tile } from \"../Map.model\"\r\nimport {\r\n  defineEmits,\r\n  defineProps,\r\n  PropType,\r\n  watch,\r\n  getCurrentInstance,\r\n} from \"vue\"\r\nimport { Store } from \"@/store/store.model\"\r\n\r\nconst instance = getCurrentInstance()\r\nconst store = inject<Store>(\"store\") as Store\r\n\r\nconst props = defineProps({\r\n  modelValue: Boolean,\r\n  tiles: {\r\n    type: Array as PropType<Tile[]>,\r\n    default: () => [],\r\n  },\r\n  layersClass: [String, Array, Object],\r\n  layersStyle: Object,\r\n})\r\n\r\nconst emit = defineEmits([\"update:modelValue\"])\r\n\r\nconst updateModel = (value: boolean) => {\r\n  emit(\"update:modelValue\", value)\r\n}\r\n\r\nconst showTiles = ref(false)\r\nwatch(\r\n  () => props.modelValue,\r\n  (newValue) => {\r\n    if (newValue) {\r\n      setTimeout(() => {\r\n        showTiles.value = true\r\n        instance?.proxy?.$forceUpdate()\r\n      }, 200)\r\n    }\r\n  }\r\n)\r\n\r\nconst close = () => {\r\n  showTiles.value = false\r\n  instance?.proxy?.$forceUpdate()\r\n  setTimeout(() => {\r\n    updateModel(false)\r\n  }, 200)\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.mobile-settings-container {\r\n  top: 0;\r\n  bottom: 0;\r\n  width: 100%;\r\n  background-color: rgba(0, 0, 0, 0.221);\r\n  z-index: 1000001;\r\n  .mobile-settings {\r\n    bottom: 0;\r\n    width: 100%;\r\n    transition: 0.2s;\r\n    max-height: 0;\r\n    background-color: white;\r\n    border-top-left-radius: 0.5em;\r\n    border-top-right-radius: 0.5em;\r\n    box-sizing: border-box;\r\n    &[activated=\"true\"] {\r\n      max-height: 70%;\r\n      transition: 0.2s;\r\n    }\r\n    .map-types {\r\n      flex-wrap: wrap;\r\n    }\r\n    .map-layers {\r\n      flex-wrap: wrap;\r\n      margin-top: 1em;\r\n      margin-bottom: 0.5em;\r\n    }\r\n  }\r\n  .tile {\r\n    text-align: center;\r\n    flex: 0 0 auto;\r\n    flex-flow: column;\r\n    width: 6em;\r\n    margin: 0 auto 10px auto;\r\n    height: 6em;\r\n    img {\r\n      height: calc(6em - var(--text-sm) - 0.3em);\r\n      width: calc(6em - var(--text-sm) - 0.3em);\r\n      border-radius: 0.5em;\r\n    }\r\n    &[selected=\"true\"] {\r\n      img {\r\n        border: 1px solid var(--primary);\r\n      }\r\n      color: var(--primary);\r\n    }\r\n  }\r\n}\r\n</style>\r\n","export const inlineSvgs = {\r\n  close: {\r\n    d: \"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z\",\r\n  },\r\n  magnet: {\r\n    d: \"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z\",\r\n  },\r\n  neighborhood_landmark: {\r\n    d: \"M17,16H15V22H12V17H8V22H5V16H3L10,10L17,16M6,2L10,6H9V9H7V6H5V9H3V6H2L6,2M18,3L23,8H22V12H19V9H17V12H15.34L14,10.87V8H13L18,3Z\",\r\n  },\r\n  formal_school: {\r\n    d: \"M12,3L1,9L12,15L21,10.09V17H23V9M5,13.18V17.18L12,21L19,17.18V13.18L12,17L5,13.18Z\",\r\n  },\r\n  university: {\r\n    d: \"M12,3L1,9L12,15L21,10.09V17H23V9M5,13.18V17.18L12,21L19,17.18V13.18L12,17L5,13.18Z\",\r\n  },\r\n  primary: {\r\n    d: \"M18.1,4.8C18,4.3 17.6,4 17.1,4H13L13.2,7H10.8L11,4H6.8C6.3,4 5.9,4.4 5.8,4.8L3.1,18.8C3,19.4 3.5,20 4.1,20H10L10.3,15H13.7L14,20H19.8C20.4,20 20.9,19.4 20.8,18.8L18.1,4.8M10.4,13L10.6,9H13.2L13.4,13H10.4Z\",\r\n  },\r\n  secondary: {\r\n    d: \"M18.1,4.8C18,4.3 17.6,4 17.1,4H13L13.2,7H10.8L11,4H6.8C6.3,4 5.9,4.4 5.8,4.8L3.1,18.8C3,19.4 3.5,20 4.1,20H10L10.3,15H13.7L14,20H19.8C20.4,20 20.9,19.4 20.8,18.8L18.1,4.8M10.4,13L10.6,9H13.2L13.4,13H10.4Z\",\r\n    scale: 0.8,\r\n  },\r\n  tertiary: {\r\n    d: \"M18.1,4.8C18,4.3 17.6,4 17.1,4H13L13.2,7H10.8L11,4H6.8C6.3,4 5.9,4.4 5.8,4.8L3.1,18.8C3,19.4 3.5,20 4.1,20H10L10.3,15H13.7L14,20H19.8C20.4,20 20.9,19.4 20.8,18.8L18.1,4.8M10.4,13L10.6,9H13.2L13.4,13H10.4Z\",\r\n    scale: 0.6,\r\n  },\r\n  vaccine: {\r\n    d: \"M11.15,15.18L9.73,13.77L11.15,12.35L12.56,13.77L13.97,12.35L12.56,10.94L13.97,9.53L15.39,10.94L16.8,9.53L13.97,6.7L6.9,13.77L9.73,16.6L11.15,15.18M3.08,19L6.2,15.89L4.08,13.77L13.97,3.87L16.1,6L17.5,4.58L16.1,3.16L17.5,1.75L21.75,6L20.34,7.4L18.92,6L17.5,7.4L19.63,9.53L9.73,19.42L7.61,17.3L3.08,21.84V19Z\",\r\n  },\r\n  subway_station: {\r\n    d: \"M8.5,15A1,1 0 0,1 9.5,16A1,1 0 0,1 8.5,17A1,1 0 0,1 7.5,16A1,1 0 0,1 8.5,15M7,9H17V14H7V9M15.5,15A1,1 0 0,1 16.5,16A1,1 0 0,1 15.5,17A1,1 0 0,1 14.5,16A1,1 0 0,1 15.5,15M18,15.88V9C18,6.38 15.32,6 12,6C9,6 6,6.37 6,9V15.88A2.62,2.62 0 0,0 8.62,18.5L7.5,19.62V20H9.17L10.67,18.5H13.5L15,20H16.5V19.62L15.37,18.5C16.82,18.5 18,17.33 18,15.88M17.8,2.8C20.47,3.84 22,6.05 22,8.86V22H2V8.86C2,6.05 3.53,3.84 6.2,2.8C8,2.09 10.14,2 12,2C13.86,2 16,2.09 17.8,2.8Z\",\r\n  },\r\n  metro_entrance: {\r\n    d: \"M6 11V13H4V11H6M22 5H17V19H22V5M7 5H2L2 19H7V5M22 3C23.11 3 24 3.89 24 5V21H0V5C0 3.89 .894 3 2 3H9V19H15V3H22M20 11H18V13H20V11Z\",\r\n    scale: 0.8,\r\n  },\r\n  footway: {\r\n    d: \"M10.74,11.72C11.21,12.95 11.16,14.23 9.75,14.74C6.85,15.81 6.2,13 6.16,12.86L10.74,11.72M5.71,10.91L10.03,9.84C9.84,8.79 10.13,7.74 10.13,6.5C10.13,4.82 8.8,1.53 6.68,2.06C4.26,2.66 3.91,5.35 4,6.65C4.12,7.95 5.64,10.73 5.71,10.91M17.85,19.85C17.82,20 17.16,22.8 14.26,21.74C12.86,21.22 12.8,19.94 13.27,18.71L17.85,19.85M20,13.65C20.1,12.35 19.76,9.65 17.33,9.05C15.22,8.5 13.89,11.81 13.89,13.5C13.89,14.73 14.17,15.78 14,16.83L18.3,17.9C18.38,17.72 19.89,14.94 20,13.65Z\",\r\n  },\r\n  department_store: {\r\n    d: \"M12,18H6V14H12M21,14V12L20,7H4L3,12V14H4V20H14V14H18V20H20V14M20,4H4V6H20V4Z\",\r\n  },\r\n  internet_cafe: {\r\n    d: \"M8.95 13.4H6.58A5.5 5.5 0 0 1 6.58 10.6H8.95A11.56 11.56 0 0 0 8.85 12A11.56 11.56 0 0 0 8.95 13.4M7.16 9.2H9.2A12.06 12.06 0 0 1 10.18 6.71A5.55 5.55 0 0 0 7.16 9.2M16.84 9.2A5.59 5.59 0 0 0 13.81 6.71A10.95 10.95 0 0 1 14.78 9.2M12 17.57A9.5 9.5 0 0 0 13.34 14.8H10.66A9.5 9.5 0 0 0 12 17.57M12 6.42A9.53 9.53 0 0 0 10.66 9.2H13.34A9.53 9.53 0 0 0 12 6.42M7.16 14.8A5.61 5.61 0 0 0 10.18 17.29A12.06 12.06 0 0 1 9.2 14.8M21 5V19A2 2 0 0 1 19 21H5A2 2 0 0 1 3 19V5A2 2 0 0 1 5 3H19A2 2 0 0 1 21 5M19 12A7 7 0 1 0 12 19A7 7 0 0 0 19 12M15.15 12A11.56 11.56 0 0 1 15.05 13.4H17.42A5.5 5.5 0 0 0 17.42 10.6H15.05A11.56 11.56 0 0 1 15.15 12M13.81 17.29A5.62 5.62 0 0 0 16.84 14.8H14.78A10.95 10.95 0 0 1 13.81 17.29M10.36 10.6A8.81 8.81 0 0 0 10.36 13.4H13.64A10.3 10.3 0 0 0 13.75 12A10.21 10.21 0 0 0 13.64 10.6Z\",\r\n  },\r\n  park: {\r\n    d: \"M10,21V18H3L8,13H5L10,8H7L12,3L17,8H14L19,13H16L21,18H14V21H10Z\",\r\n  },\r\n  hotel: {\r\n    d: \"M480 0C497.7 0 512 14.33 512 32C512 49.67 497.7 64 480 64V448C497.7 448 512 462.3 512 480C512 497.7 497.7 512 480 512H304V448H208V512H32C14.33 512 0 497.7 0 480C0 462.3 14.33 448 32 448V64C14.33 64 0 49.67 0 32C0 14.33 14.33 0 32 0H480zM112 96C103.2 96 96 103.2 96 112V144C96 152.8 103.2 160 112 160H144C152.8 160 160 152.8 160 144V112C160 103.2 152.8 96 144 96H112zM224 144C224 152.8 231.2 160 240 160H272C280.8 160 288 152.8 288 144V112C288 103.2 280.8 96 272 96H240C231.2 96 224 103.2 224 112V144zM368 96C359.2 96 352 103.2 352 112V144C352 152.8 359.2 160 368 160H400C408.8 160 416 152.8 416 144V112C416 103.2 408.8 96 400 96H368zM96 240C96 248.8 103.2 256 112 256H144C152.8 256 160 248.8 160 240V208C160 199.2 152.8 192 144 192H112C103.2 192 96 199.2 96 208V240zM240 192C231.2 192 224 199.2 224 208V240C224 248.8 231.2 256 240 256H272C280.8 256 288 248.8 288 240V208C288 199.2 280.8 192 272 192H240zM352 240C352 248.8 359.2 256 368 256H400C408.8 256 416 248.8 416 240V208C416 199.2 408.8 192 400 192H368C359.2 192 352 199.2 352 208V240zM256 288C211.2 288 173.5 318.7 162.1 360.2C159.7 373.1 170.7 384 184 384H328C341.3 384 352.3 373.1 349 360.2C338.5 318.7 300.8 288 256 288z\",\r\n  },\r\n  local_government_office: {\r\n    d: \"M5,3V21H11V17.5H13V21H19V3H5M7,5H9V7H7V5M11,5H13V7H11V5M15,5H17V7H15V5M7,9H9V11H7V9M11,9H13V11H11V9M15,9H17V11H15V9M7,13H9V15H7V13M11,13H13V15H11V13M15,13H17V15H15V13M7,17H9V19H7V17M15,17H17V19H15V17Z\",\r\n  },\r\n  marker: {\r\n    d: \"M12,11.5A2.5,2.5 0 0,1 9.5,9A2.5,2.5 0 0,1 12,6.5A2.5,2.5 0 0,1 14.5,9A2.5,2.5 0 0,1 12,11.5M12,2A7,7 0 0,0 5,9C5,14.25 12,22 12,22C12,22 19,14.25 19,9A7,7 0 0,0 12,2Z\",\r\n  },\r\n  city: {\r\n    d: \"M19,15H17V13H19M19,19H17V17H19M13,7H11V5H13M13,11H11V9H13M13,15H11V13H13M13,19H11V17H13M7,11H5V9H7M7,15H5V13H7M7,19H5V17H7M15,11V5L12,2L9,5V7H3V21H21V11H15Z\",\r\n  },\r\n  residential: {\r\n    d: \"M17,16H15V22H12V17H8V22H5V16H3L10,10L17,16M6,2L10,6H9V9H7V6H5V9H3V6H2L6,2M18,3L23,8H22V12H19V9H17V12H15.34L14,10.87V8H13L18,3Z\",\r\n  },\r\n  back: {\r\n    d: \"M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z\",\r\n  },\r\n}\r\n\r\nexport const defaultIcons = {\r\n  place: {\r\n    d: inlineSvgs.neighborhood_landmark.d,\r\n  },\r\n  municipal: {\r\n    d: inlineSvgs.primary.d,\r\n  },\r\n}\r\n","<template>\r\n  <svg\r\n    :style=\"`width: ${computedSize}px; height: ${computedSize}px`\"\r\n    viewBox=\"0 0 24 24\"\r\n  >\r\n    <path :fill=\"color || 'currentColor'\" :d=\"inlineSvgs[name].d\" />\r\n  </svg>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { PropType, defineProps, inject, computed } from \"vue\"\r\nimport { RouteTypes } from \"../../static/index.model\"\r\nimport { inlineSvgs } from \"../../static/index\"\r\nimport { Store } from \"@/store/store.model\"\r\nconst props = defineProps({\r\n  name: {\r\n    type: String as PropType<RouteTypes>,\r\n    default: \"close\",\r\n  },\r\n  size: {\r\n    type: Number,\r\n    default: 15,\r\n  },\r\n  color: String,\r\n  scale: {\r\n    type: Boolean,\r\n    default: true,\r\n  },\r\n})\r\n\r\nconst computedSize = computed(() => {\r\n  return props.scale ? store.state.scale * props.size : props.size\r\n})\r\n\r\nconst store = inject<Store>(\"store\") as Store\r\n</script>\r\n","import { Tile } from \"../components/Map.model\"\r\n\r\nexport const urls = {\r\n  reverse: \"https://api.neshan.org/v4/reverse\",\r\n  search: \"https://api.neshan.org/v1/search\",\r\n  map: \"https://static.neshan.org/sdk/openlayers/5.3.0/ol.js\",\r\n}\r\n\r\nexport const markerUrls = {\r\n  main: \"src/assets/images/main-marker.png\",\r\n  // blue: \"https://img.icons8.com/ultraviolet/344/marker.png\",\r\n  search: \"https://static.neshanmap.ir/poi/square/\",\r\n  colorSvg: \"https://static.neshanmap.ir/poi/svg/color/\",\r\n  greySvg: \"https://static.neshanmap.ir/poi/svg/grey/\",\r\n  preview256: \"https://static.neshanmap.ir/poi/256/\",\r\n  searchPrev: \"/images/search-marker-prev.png\",\r\n}\r\n\r\nexport const tiles: Tile[] = [\r\n  {\r\n    title: \"osm-bright\",\r\n    url: \"https://static.neshan.org/sdk/examples/maptypes/images/map-types-bright.png\",\r\n  },\r\n  {\r\n    title: \"standard-night\",\r\n    url: \"https://static.neshan.org/sdk/examples/maptypes/images/map-types-standard-night.png\",\r\n  },\r\n  {\r\n    title: \"standard-day\",\r\n    url: \"https://static.neshan.org/sdk/examples/maptypes/images/map-types-standard-day.png\",\r\n  },\r\n  {\r\n    title: \"neshan\",\r\n    url: \"https://static.neshan.org/sdk/examples/maptypes/images/map-types-neshan.png\",\r\n  },\r\n  {\r\n    title: \"dreamy-gold\",\r\n    url: \"https://static.neshan.org/sdk/examples/maptypes/images/map-types-dreamy-gold.png\",\r\n  },\r\n  {\r\n    title: \"dreamy\",\r\n    url: \"https://static.neshan.org/sdk/examples/maptypes/images/map-types-dreamy.png\",\r\n  },\r\n]\r\n\r\nexport const breakpointsSegments = {\r\n  xs: false,\r\n  sm: false,\r\n  md: false,\r\n  lg: false,\r\n  xl: false,\r\n}\r\nexport const breakpointsSegmentsPixels = {\r\n  xs: 0,\r\n  sm: 600,\r\n  md: 1024,\r\n  lg: 1440,\r\n  xl: 1920,\r\n}\r\n\r\nexport const drawerConstants = {\r\n  width: \"18em\",\r\n  bottomSheetNormalHeight: \"5em\",\r\n  bottomSheetloadingHeight: \"2em\",\r\n  bottomSheetBorderRadius: \"1em 1em 0 0\",\r\n}\r\n\r\nexport const unsetMapDimnensions = {\r\n  width: \"700px\",\r\n  height: \"1000px\",\r\n}\r\n\r\nexport const zoomConstants = {\r\n  initialZoom: 12,\r\n  maxZoom: 18.5,\r\n}\r\n\r\nexport const markersOffset = {\r\n  high: [0, -60],\r\n  short: [0, -40],\r\n}\r\n","<template>\r\n  <div\r\n    :activated=\"store.state.drawerActivation\"\r\n    :style=\"`width: ${width}; ${searchBoxStyle}`\"\r\n    class=\"map-search-box d-flex justify-between align-center mx-auto\"\r\n    :class=\"searchBoxClass\"\r\n  >\r\n    <input\r\n      type=\"search\"\r\n      name=\"search\"\r\n      placeholder=\"جستجو\"\r\n      v-model=\"text\"\r\n      @keydown.enter=\"runTimeout(text, 0)\"\r\n      @focus=\"store.state.drawerActivation = true\"\r\n    />\r\n    <button\r\n      v-if=\"store.state.drawerShowDetails && !store.getters.touchPlatform\"\r\n      @click=\"store.state.drawerShowDetails = false\"\r\n      class=\"pointer\"\r\n    >\r\n      <Icon name=\"back\" :size=\"19\"></Icon>\r\n    </button>\r\n    <button\r\n      v-if=\"!store.state.drawerActivation\"\r\n      @click=\"store.state.drawerActivation = true\"\r\n      class=\"pointer\"\r\n    >\r\n      <Icon name=\"magnet\" :size=\"19\"></Icon>\r\n    </button>\r\n    <button v-else class=\"pointer\" @click=\"store.state.drawerActivation = false\">\r\n      <Icon name=\"close\" :size=\"19\"></Icon>\r\n    </button>\r\n  </div>\r\n</template>\r\n<script setup lang=\"ts\">\r\nimport { defineProps, defineEmits, computed, inject } from \"vue\"\r\nimport Icon from \"../icons/IconComponent.vue\"\r\nimport { drawerConstants } from \"@/parameters\"\r\nimport { Store } from \"@/store/store.model\";\r\n\r\nconst props = defineProps({\r\n  searchBoxClass: [String, Array, Object],\r\n  searchBoxStyle: Object,\r\n  searchText: {\r\n    type: String,\r\n  },\r\n})\r\n\r\nconst store = inject<Store>('store') as Store\r\n\r\nconst width = drawerConstants.width\r\nconst emit = defineEmits([\r\n  \"update:search-text\",\r\n  \"update:search-coords\",\r\n  \"submit\",\r\n])\r\nconst text = computed({\r\n  get: () => props.searchText,\r\n  set: (val) => {\r\n    emit(\"update:search-text\", val)\r\n    runTimeout(val)\r\n  },\r\n})\r\n\r\n/**\r\n * Emits Search Term to the parent component\r\n * @param term search text\r\n */\r\nconst emitSearch = (term = \"\") => {\r\n  const inputText = term || text.value?.trim()\r\n  emit(\"submit\", inputText)\r\n}\r\n\r\nlet emitTimeout: number\r\n/**\r\n * Runs and updates a timeout so after that if fires emitSearch function\r\n * @param value - searching value\r\n * @param delay - delay time for emiting search, defaults to 1000\r\n */\r\nconst runTimeout = (value = text.value, delay = 1000) => {\r\n  clearTimeout(emitTimeout)\r\n  if (!value) {\r\n    store.state.searchLoading = false\r\n    return\r\n  } else if (!store.state.searchLoading) {\r\n    store.state.searchLoading = true\r\n  }\r\n  emitTimeout = window.setTimeout(() => {\r\n    emitSearch(value)\r\n  }, delay)\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.touch .map-search-box input[type=\"search\"] {\r\n  line-height: 1.7em;\r\n  font-size: var(--text-lg);\r\n  height: 2.7em;\r\n}\r\n.map-search-box {\r\n  border-radius: 0.7em;\r\n  padding-right: 0.5em;\r\n  padding-left: 0.5em;\r\n  background-color: white;\r\n  transition: inherit;\r\n  input[type=\"search\"] {\r\n    border: none;\r\n    background: inherit;\r\n    outline: none;\r\n    line-height: 1.5em;\r\n    font-size: 1em;\r\n    height: 2.3em;\r\n    padding-right: 0.5em;\r\n    width: 100%;\r\n    font-family: inherit;\r\n  }\r\n  input[type=\"search\"]:-webkit-autofill,\r\n  input[type=\"search\"]:-webkit-autofill:hover,\r\n  input[type=\"search\"]:-webkit-autofill:focus,\r\n  input[type=\"search\"]:-webkit-autofill:active {\r\n    // To stop the browser from changing background color\r\n    transition: background-color 5000s ease-in-out 0s;\r\n  }\r\n  input[type=\"search\"]::-webkit-search-decoration,\r\n  input[type=\"search\"]::-webkit-search-cancel-button,\r\n  input[type=\"search\"]::-webkit-search-results-button,\r\n  input[type=\"search\"]::-webkit-search-results-decoration {\r\n    -webkit-appearance: none;\r\n  }\r\n  button {\r\n    border-radius: 5px;\r\n    background-color: inherit;\r\n    border: none;\r\n    padding: 0;\r\n  }\r\n}\r\n\r\n.map-search-box[activated=\"true\"] {\r\n  align-items: center;\r\n  background: #f5f5f5;\r\n  border: 1px solid #d9d9d9;\r\n  box-shadow: none;\r\n  // height: 40px;\r\n  margin-top: 1em;\r\n  margin-bottom: 1em;\r\n  pointer-events: auto;\r\n  // width: 308px;\r\n}\r\n</style>\r\n","declare const ol: any // eslint-disable-line\r\nimport { ReverseResult } from '../store/markers/markers.model'\r\nimport { Coordinate } from 'openlayers'\r\nimport {\r\n  CoordsObj,\r\n} from '../components/Map.model'\r\n/**\r\n * Creates the sufficent title based on result data.\r\n * @param data - result of neshan web search\r\n * @returns title\r\n */\r\nexport const getTitleFromData = (data: ReverseResult) => {\r\n  const mainTitle = data.place\r\n    ? data.place\r\n    : data.route_name\r\n    ? data.route_name\r\n    : 'معبر بدون نام'\r\n  const fullTitle = data.neighbourhood\r\n    ? mainTitle + `، ${data.neighbourhood}`\r\n    : mainTitle\r\n  return fullTitle\r\n}\r\n\r\n/**\r\n * Get the object of location and turns it into array\r\n * @param loc - location object\r\n * @returns\r\n */\r\nexport const sanitizeLocation = (loc?: CoordsObj) => {\r\n  return loc\r\n    ? loc instanceof Object\r\n      ? ([loc.longitude, loc.latitude] as Coordinate)\r\n      : loc\r\n    : undefined\r\n}\r\n\r\n/**\r\n * Gets the device location\r\n * if it was succesfull, formats it and returns\r\n * otherwise, sends Neshan locaton\r\n * @returns location array\r\n */\r\nexport const getLocation = async () => {\r\n  const positionPromise: Promise<GeolocationPosition> = new Promise(\r\n    (resolve) => {\r\n      navigator.geolocation.getCurrentPosition((pos) => {\r\n        resolve(pos)\r\n      })\r\n    }\r\n  )\r\n  const position = await positionPromise\r\n  return (\r\n    (position && sanitizeLocation(position.coords)) ||\r\n    (Object.values(createCoordsObject()) as Coordinate)\r\n  )\r\n}\r\n\r\n/**\r\n * Create an object for a quick lat lng access\r\n */\r\nexport const createCoordsObject = () => {\r\n  return {\r\n    longitude: 59.5870851,\r\n    latitude: 36.311559,\r\n  }\r\n}\r\n\r\n/**\r\n * Transforms common latlng to open layers-friendly latlng\r\n * @param point\r\n * @param from\r\n * @param to\r\n * @returns points\r\n */\r\nexport const transformCoords = (\r\n  point: Coordinate,\r\n  from = 'EPSG:3857',\r\n  to = 'EPSG:4326'\r\n): Coordinate => {\r\n  return ol.proj.transform(point, from, to)\r\n}\r\n","declare const ol: any\r\nimport {\r\n  CreateIconProps,\r\n  CreateLayerProps,\r\n  CreateMapPointsOptions,\r\n  CreateMarkers,\r\n  CreateMarkersOptions,\r\n  CreateMarkersPoints,\r\n  CreateMarkersPointsItem,\r\n  CreateRawStyleProps,\r\n  CreateStyleProps,\r\n  MarkersIconCallback,\r\n  Ol,\r\n  Style,\r\n  // Text,\r\n  VectorLayer,\r\n} from \"../components/Map.model\"\r\nimport { markerUrls } from \"@/parameters\"\r\nimport { PrimarySearchItem } from \"../store/markers/markers.model\"\r\nimport { Coordinate, Feature, geom, Extent } from \"openlayers\"\r\nimport { transformCoords } from \"./location.util\"\r\n\r\n/**\r\n * Receives an array of points and returns a layer of markers.\r\n * @param points - Array of points.\r\n * @param point.coords - Coordinates of that point.\r\n * @param point.text - If you have a particular text for the point.\r\n * @param point.color - If you have a particular color for that point (only checks the first point for now).\r\n * @param point.image - If you have a particular image for that point (only checks the first point for now).\r\n * @param point.iconScale - If you have a particular icon scale for that point (only checks the first point for now).\r\n * @param point.originalItem - original item from neshan search result\r\n * @param point.props - props to set for point feature\r\n * @param options.hidePopup - If you don't want to show popup\r\n * @param options.cluster - If these markers need to be clusterd on given zoom number\r\n * @param options.clusterThreshold - Zoom number that markers should be clusterd on zoom condition above that given zoom\r\n * @param options.props - Props to set for all features\r\n * @returns style and layer.\r\n */\r\nexport const createMarkers: CreateMarkers = (points, options) => {\r\n  const [{ iconScale } = {} as CreateMarkersPointsItem] = points\r\n  const features = createFeaturesFromPoints(\r\n    points,\r\n    options?.markersIconCallback,\r\n    {\r\n      isCluster: options?.cluster,\r\n      ...options?.props,\r\n    }\r\n  )\r\n  let layer: VectorLayer\r\n  let _style: Style | undefined\r\n  if (options?.cluster) {\r\n    layer = createClusterLayer(features, options)\r\n  } else {\r\n    const { styleFunc, style } = createStyle({\r\n      hidePopup: options?.hidePopup,\r\n      iconScale,\r\n      anchor: options?.anchor,\r\n    })\r\n    _style = style\r\n    const source = createSource(features)\r\n    layer = createLayer({ style: styleFunc, source })\r\n  }\r\n  return { layer, style: _style }\r\n}\r\n\r\n// const createText = (): Text => {\r\n//   return new ol.style.Text({\r\n//     overflow: true,\r\n//     scale: 1.6,\r\n//     offsetY: -43,\r\n//     fill: new ol.style.Fill({\r\n//       color: \"#fff\",\r\n//     }),\r\n//     stroke: new ol.style.Stroke({\r\n//       color: \"0\",\r\n//       width: 2,\r\n//     }),\r\n//   })\r\n// }\r\n\r\nexport const createIcon = ({\r\n  iconScale = 0.24,\r\n  src = markerUrls.main,\r\n  anchor = [0.5, 0.5],\r\n}: CreateIconProps = {}): Ol.style.Image => {\r\n  return new ol.style.Icon({\r\n    src,\r\n    scale: iconScale,\r\n    anchor,\r\n  })\r\n}\r\n\r\nexport const createRawStyle = ({ image, text }: CreateRawStyleProps): Style => {\r\n  return new ol.style.Style({\r\n    image: image,\r\n    text: text,\r\n  })\r\n}\r\n\r\nexport const createStyle = ({\r\n  hidePopup = false,\r\n  iconScale,\r\n  anchor,\r\n}: CreateStyleProps) => {\r\n  const _style = createRawStyle({})\r\n  const styleFunc = styleFuncGen(_style, {\r\n    hidePopup,\r\n    iconScale,\r\n    anchor,\r\n  })\r\n  return { style: _style, styleFunc }\r\n}\r\n\r\n/**\r\n * Creates ol source from given features\r\n * @param features\r\n * @returns ol source\r\n */\r\nconst createSource = (features: Feature[]): Ol.source.Vector => {\r\n  return new ol.source.Vector({\r\n    features,\r\n    // projection: map.value.getView().projection, // Is it neccesary?\r\n  })\r\n}\r\n\r\n/**\r\n * Creates ol layer\r\n * @returns ol layer\r\n */\r\nexport const createLayer = ({\r\n  target = \"points\",\r\n  style,\r\n  source,\r\n}: CreateLayerProps): Ol.layer.Vector => {\r\n  return new ol.layer.Vector({\r\n    target,\r\n    source,\r\n    style,\r\n  })\r\n}\r\n\r\n/**\r\n * Converts points given from neshan server to openlayers-friendly points\r\n * checks if icon type has a respective icon url\r\n * @param items - Items from search result\r\n * @param options.color - color of the markers\r\n * @param options.iconScale - scale of the markers\r\n */\r\nexport const createMapPoints = async (\r\n  items: PrimarySearchItem[],\r\n  options?: CreateMapPointsOptions\r\n) => {\r\n  return await Promise.all(\r\n    items.map(async (item) => {\r\n      const point: Coordinate = [item.location.x, item.location.y]\r\n      const mapPoint = transformCoords(point, \"EPSG:4326\", \"EPSG:3857\")\r\n      const iconImageExists = await checkIconImageExistance(item.type)\r\n      const iconUrl = iconImageExists.url\r\n      return {\r\n        coords: mapPoint,\r\n        text: item.title,\r\n        iconUrl,\r\n        iconScale: options?.iconScale || 0.25,\r\n        originalItem: item,\r\n      }\r\n    })\r\n  )\r\n}\r\n\r\n/**\r\n * Checks if icon url exists or not\r\n * @param iconName\r\n * @returns\r\n */\r\nexport const checkIconImageExistance = async (iconName: string) => {\r\n  const searchUrl = markerUrls.search + iconName + \".png\"\r\n  const exists = await urlExists(searchUrl)\r\n  const url = exists ? searchUrl : markerUrls.search + \"general.png\"\r\n  return { url, exists }\r\n}\r\n\r\nconst urlExists = (url: string) => {\r\n  return new Promise((resolve: (val: boolean) => void) => {\r\n    fetch(url, { method: \"head\" })\r\n      .then((status) => resolve(status.ok))\r\n      .catch(() => resolve(false))\r\n  })\r\n}\r\n\r\n/**\r\n * Creates an style function to dynamically change popup text and marker icons\r\n * @param style - The static raw style\r\n * @param options.hidePopup - Will not use popups and just hard text\r\n * @returns\r\n */\r\nconst styleFuncGen = (\r\n  style: Style,\r\n  { hidePopup = false, iconScale, anchor }: CreateStyleProps\r\n): Ol.StyleFunction => {\r\n  return (feature) => {\r\n    if (hidePopup) {\r\n      style.getText().setText(feature.get(\"text\"))\r\n    }\r\n    const iconProps: CreateIconProps = feature.get(\"iconProps\")\r\n    const rawCreateIconProps = {\r\n      src: feature.get(\"iconUrl\"),\r\n      iconScale,\r\n      anchor,\r\n    }\r\n    const createIconProps = iconProps\r\n      ? { ...rawCreateIconProps, ...iconProps }\r\n      : rawCreateIconProps\r\n    style.setImage(createIcon(createIconProps))\r\n    return style\r\n  }\r\n}\r\n\r\nexport const createClusterSource = (\r\n  features: Feature[],\r\n  { minDistance = 30, distance = 30 } = {}\r\n): Ol.source.Cluster => {\r\n  return new ol.source.Cluster({\r\n    distance,\r\n    minDistance,\r\n    source: createSource(features),\r\n  })\r\n}\r\n\r\nconst createClusterText = (size: number): Ol.style.Text => {\r\n  return new ol.style.Text({\r\n    text: size.toString(),\r\n    font: \"bold 15px serif\",\r\n    fill: new ol.style.Fill({\r\n      color: [0, 0, 0, 1],\r\n    }),\r\n  })\r\n}\r\n\r\nconst createClusterCircle = () => {\r\n  return new ol.style.Circle({\r\n    radius: 15,\r\n    stroke: new ol.style.Stroke({\r\n      color: [255, 255, 255, 0.7],\r\n      width: 4,\r\n    }),\r\n    fill: new ol.style.Fill({\r\n      color: [0, 153, 255, 0.7],\r\n    }),\r\n  })\r\n}\r\n\r\nconst createClusterStyle = (size: number) => {\r\n  return new ol.style.Style({\r\n    image: createClusterCircle(),\r\n    text: createClusterText(size),\r\n  })\r\n}\r\n\r\n/**\r\n * Creates a style function for the clusters.\r\n * That if they are pointing to a single marker\r\n * the icon shown is the icon for single markers.\r\n * @param hidePopup - whether it should show a popup on hover or is a static text\r\n * @returns\r\n */\r\nconst createClusterStyleFunc = (hidePopup?: boolean) => {\r\n  const styleCache: { [s: string]: Style | Style[] | null } = {}\r\n  return (clusterFeature: Feature) => {\r\n    const innerFeatures: Feature[] = clusterFeature.get(\"features\")\r\n    if (!hidePopup) {\r\n      clusterFeature.set(\r\n        \"text\",\r\n        innerFeatures.map((feat: Feature) => feat.get(\"text\"))\r\n      )\r\n    }\r\n    clusterFeature.set(\"isCluster\", innerFeatures[0].get(\"isCluster\"))\r\n    const size = innerFeatures.length\r\n    let style = styleCache[size]\r\n    if (!style) {\r\n      if (size !== 1) {\r\n        style = createClusterStyle(size)\r\n        styleCache[size] = style\r\n      } else {\r\n        const iconUrl: string = innerFeatures[0].get(\"iconUrl\")\r\n        const { styleFunc } = createStyle({ iconUrl, hidePopup })\r\n        style = styleFunc(innerFeatures[0], 100) // 100 is to shut its type up\r\n      }\r\n    }\r\n    return style\r\n  }\r\n}\r\n\r\nconst createClusterLayer = (\r\n  features: Feature[],\r\n  options?: CreateMarkersOptions\r\n) => {\r\n  const cluster_layer: VectorLayer = new ol.layer.Vector({\r\n    source: createClusterSource(features, {\r\n      minDistance: options?.clusterDistance,\r\n      distance: options?.clusterDistance,\r\n    }),\r\n    style: createClusterStyleFunc(options?.hidePopup),\r\n  })\r\n  return cluster_layer\r\n}\r\n\r\n/**\r\n * Gets the sufficent extent to zoom on a cluster or marker\r\n * @param cluster\r\n * @returns extent\r\n */\r\nexport const getClusterExtent = (cluster: Feature) => {\r\n  const originalFeatures = cluster.get(\"features\")\r\n  const extent: Extent = new ol.extent.createEmpty()\r\n  originalFeatures.forEach((f: Feature) => {\r\n    ol.extent.extend(extent, getFeatureExtent(f))\r\n  })\r\n  return extent\r\n}\r\n\r\n/**\r\n * Gets the extent of a feature\r\n * @param feature\r\n * @returns extent\r\n */\r\nexport const getFeatureExtent = (feature: Feature) => {\r\n  return feature.getGeometry().getExtent()\r\n}\r\n\r\n/**\r\n * Takes a feature and returns text value from its properties\r\n * and ol coords on map\r\n * @param feature\r\n * @returns\r\n */\r\nexport const getCoordsAndTextFromFeature = (feature: Feature) => {\r\n  const featCoords = getCoordsFromFeature(feature)\r\n  const featText: string[] | string = feature.getProperties().text\r\n  return {\r\n    featCoords,\r\n    featText,\r\n  }\r\n}\r\n\r\n/**\r\n * Gets OpenLayer Coordinates of the given feature\r\n * @param feature\r\n * @returns Coords array\r\n */\r\nexport const getCoordsFromFeature = (feature: Feature) => {\r\n  const geometry: geom.Point = <geom.Point>feature.getGeometry()\r\n  return <Coordinate>geometry.getCoordinates().slice(0, 2) //slice because it return array of 3 args idk why\r\n}\r\n\r\n/**\r\n * Receives an array of points and returns an array of features.\r\n * @param points - Array of points.\r\n * @param point.text - If you have a particular text for the point.\r\n * @param proint.props - Props to set for a feature\r\n * @param props - Props to set for features\r\n * @returns array of features.\r\n */\r\nexport const createFeaturesFromPoints = (\r\n  points: CreateMarkersPoints,\r\n  markersIconCallback?: MarkersIconCallback,\r\n  props?: any\r\n): Feature[] => {\r\n  return points.map((point) => {\r\n    const feature: Feature = new ol.Feature({\r\n      geometry: new ol.geom.Point(point.coords) as geom.Point,\r\n      text: point.text,\r\n      iconUrl: point.iconUrl,\r\n      iconProps: markersIconCallback && markersIconCallback(point),\r\n      mainMarker: point.isReverseMarker,\r\n      ...point.props,\r\n      ...props,\r\n    })\r\n\r\n    feature.setId(props.id || point.coords.join(\"-\"))\r\n    return feature\r\n  })\r\n}\r\n","export * from \"./location.util\"\r\nexport * from \"./features.util\"\r\n\r\n/**\r\n * Tells if current platform is mobile/tablet or a desktop/non-touchable device\r\n * @returns \r\n */\r\nexport function isTouchPlatform() {\r\n  let check = false\r\n  ;(function (a) {\r\n    if (\r\n      /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(\r\n        a\r\n      ) || // eslint-disable-next-line\r\n      /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(\r\n        a.substr(0, 4)\r\n      )\r\n    )\r\n      check = true\r\n    // eslint-disable-next-line\r\n    // @ts-ignore\r\n  })(navigator.userAgent || navigator.vendor || window.opera)\r\n  return check\r\n}\r\n","import { EventsMixinProps } from \"../components/Map.model\"\r\nimport { SearchItem } from \"../store/markers/markers.model\"\r\nimport { Feature, MapBrowserEvent } from \"openlayers\"\r\nimport {\r\n  getCoordsAndTextFromFeature,\r\n  getClusterExtent,\r\n  getCoordsFromFeature,\r\n  transformCoords,\r\n} from \"../utils\"\r\nimport { markersOffset } from \"@/parameters\"\r\n\r\nexport function eventsMixin({\r\n  emits,\r\n  store,\r\n  markerHoverCallback,\r\n  zoomOnMarkerClick,\r\n  zoomOnResultClick,\r\n  popupOnMarkerHover,\r\n  popupOnResultHover,\r\n  reverseOnClick,\r\n  markersIconCallback\r\n}: EventsMixinProps) {\r\n  /**\r\n   * Sets the required events up for the map.\r\n   */\r\n  const setupMapEvents = () => {\r\n    setupClickEvent()\r\n    setupZoomEvent()\r\n    setupMarkerHoverEvent()\r\n    setupResizeEvents()\r\n  }\r\n\r\n  const setupClickEvent = () => {\r\n    store.state.map?.on(\"click\", (event) => {\r\n      handleClickEvent(<MapBrowserEvent>event)\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Emits the new zoom value\r\n   */\r\n  const setupZoomEvent = () => {\r\n    if (!store.state.map) return\r\n    store.state.zoom = store.state.map.getView().getZoom()\r\n    store.state.map.on(\"moveend\", () => {\r\n      if (!store.state.map) return\r\n      const newZoom = store.state.map.getView().getZoom()\r\n      if (store.state.zoom != newZoom) {\r\n        emits(\"on-zoom\", newZoom)\r\n        store.state.zoom = newZoom\r\n      }\r\n    })\r\n  }\r\n  /**\r\n   * Sets up hover event for marker popups\r\n   */\r\n  const setupMarkerHoverEvent = () => {\r\n    store.actions.overlays.setupOverlays()\r\n    store.state.map?.on(\"pointermove\", function (evt) {\r\n      const hoveredFeature = store.actions.markers.getFeatureFromEvent(\r\n        <MapBrowserEvent>evt\r\n      )\r\n      if (hoveredFeature) {\r\n        const isMainMarker: boolean = hoveredFeature.getProperties().mainMarker\r\n        const innerFeatures: Feature[] | undefined =\r\n          hoveredFeature.get(\"features\")\r\n        const { featCoords, featText } =\r\n          getCoordsAndTextFromFeature(hoveredFeature)\r\n        if (!innerFeatures || innerFeatures.length === 1) {\r\n          if (popupOnMarkerHover) {\r\n            store.actions.overlays.changeOverlayStats({\r\n              text: Array.isArray(featText) ? featText[0] : featText,\r\n              coords: featCoords,\r\n              offset: isMainMarker ? markersOffset.high : markersOffset.short,\r\n            })\r\n          }\r\n          return\r\n        }\r\n        if (markerHoverCallback) {\r\n          markerHoverCallback({\r\n            changeOverlayStats: store.actions.overlays.changeOverlayStats,\r\n            map: store.state.map,\r\n            feature: hoveredFeature,\r\n          })\r\n        }\r\n      }\r\n      store.actions.overlays.changeOverlayStats()\r\n    })\r\n  }\r\n\r\n  const setupResizeEvents = () => {\r\n    window.addEventListener(\"resize\", () =>\r\n      store.actions.dimensions.updateMapDimensions()\r\n    )\r\n    window.addEventListener(\r\n      \"resize\",\r\n      store.actions.dimensions.updateBreakpoints\r\n    )\r\n  }\r\n\r\n  /**\r\n   * After clicking on map, if there is no feature in there,\r\n   * sets a marker on that coords.\r\n   * Sends a request to api.reverse and labels the marker\r\n   * otherwise it zooms and expands on that feature\r\n   * In both cases emits an event named 'on-click' afterwards.\r\n   * @param event - Map click event.\r\n   */\r\n  const handleClickEvent = async (event: MapBrowserEvent) => {\r\n    let emittingMarker\r\n    let emittingData\r\n    const coords = transformCoords(event.coordinate)\r\n    const selectedFeature = store.actions.markers.getFeatureFromEvent(event)\r\n    const isMainMarker: boolean = selectedFeature?.getProperties().mainMarker\r\n    if (!isMainMarker && store.state.mainMarker) {\r\n      store.state.map?.removeLayer(store.state.mainMarker)\r\n    }\r\n    store.actions.overlays.changeOverlayStats(undefined, \"persistent\")\r\n    if (selectedFeature) {\r\n      if (zoomOnMarkerClick) {\r\n        handleFeatureClick(selectedFeature)\r\n      }\r\n    } else if (reverseOnClick) {\r\n      const result = await store.actions.markers.reverseOnPoint(coords, {\r\n        markersIconCallback\r\n      })\r\n      emittingMarker = result.marker\r\n      emittingData = result.data\r\n    }\r\n    emits(\"on-click\", {\r\n      event,\r\n      marker: emittingMarker,\r\n      coords,\r\n      apiData: emittingData,\r\n      map: store.state.map,\r\n      selectedFeature,\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Zooms on feature and if its just a marker, shows it on details section\r\n   * @param feature\r\n   */\r\n  const handleFeatureClick = (feature: Feature) => {\r\n    store.actions.overlays.changeOverlayStats()\r\n    const features: Feature[] | undefined = feature.get(\"features\")\r\n    if (features && features.length > 1) {\r\n      store.actions.markers.zoomToCluster(feature)\r\n    } else {\r\n      store.actions.markers.selectFeauture(feature, { delay: 0 })\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Shows a popup on the relating marker\r\n   * whenever mouse overs on its result on result box\r\n   * also can get a callBack from user\r\n   * @param item - Search item\r\n   */\r\n  const handleResultHover = (item: SearchItem) => {\r\n    const clusterResult = store.actions.markers.getClusterByCoords(\r\n      item.mapCoords\r\n    )\r\n    const cluster = clusterResult.cluster\r\n    const feature =\r\n      clusterResult.feature ||\r\n      store.actions.markers.getMarkerByCoords(item.mapCoords)\r\n    if (!feature) return\r\n    const coords = getCoordsFromFeature(cluster || feature)\r\n    if (popupOnResultHover) {\r\n      store.actions.overlays.changeOverlayStats({\r\n        coords,\r\n        text: item.title,\r\n      })\r\n    }\r\n    emits(\"on-result-hover\", { item, cluster, marker: feature })\r\n  }\r\n\r\n  /**\r\n   * Zooms on the relating marker\r\n   * and adds its overlay\r\n   * whenever its result on result box\r\n   * gets clicked\r\n   * @param item - Search item\r\n   */\r\n  const handleResultClick = (item: SearchItem) => {\r\n    store.actions.overlays.changeOverlayStats()\r\n    store.state.drawerActivation = false\r\n    if (zoomOnResultClick) {\r\n      store.actions.markers.selectFeauture(item)\r\n    }\r\n    emits(\"on-result-click\", item)\r\n  }\r\n\r\n  return {\r\n    setupMapEvents,\r\n    setupClickEvent,\r\n    setupZoomEvent,\r\n    setupMarkerHoverEvent,\r\n    handleClickEvent,\r\n    handleResultHover,\r\n    handleResultClick,\r\n    getClusterExtent,\r\n  }\r\n}\r\n","import { inlineSvgs } from \"@/static\"\r\nimport { computed } from \"vue\"\r\nimport { DetailsSectionMixin } from \"./detailsSection.mixin.model\"\r\nimport { dimensionsMixin } from \".\"\r\n\r\nexport function detailsSectionMixin({\r\n  props,\r\n  containerRef,\r\n}: DetailsSectionMixin) {\r\n  const iconName = computed(() => {\r\n    if (!props.item) return\r\n    const isReverse = \"route_type\" in props.item\r\n    const name = isReverse\r\n      ? props.item.route_type &&\r\n        Object.keys(inlineSvgs).includes(props.item.route_type)\r\n        ? props.item.route_type\r\n        : props.item.place\r\n        ? \"local_government_office\"\r\n        : \"primary\"\r\n      : props.item.type && Object.keys(inlineSvgs).includes(props.item.type)\r\n      ? props.item.type\r\n      : props.item.category === \"place\"\r\n      ? \"local_government_office\"\r\n      : \"primary\"\r\n    return name\r\n  })\r\n\r\n  const formattedItem = computed(() => {\r\n    if (!props.item) return\r\n    const isReverse = \"route_type\" in props.item\r\n    const region = isReverse\r\n      ? props.item.city || props.item.village\r\n        ? props.item.state\r\n          ? (props.item.city || props.item.village) + \", \" + props.item.state\r\n          : props.item.city || props.item.village\r\n        : props.item.state\r\n      : props.item.region\r\n    const item = {\r\n      place: isReverse ? props.item.place : props.item.title,\r\n      address: isReverse ? props.item.formatted_address : props.item.address,\r\n      region,\r\n      neighbourhood: isReverse ? 'محله ' + props.item.neighbourhood : props.item.neighbourhood,\r\n      in_odd_even_zone: isReverse ? props.item.in_odd_even_zone : null,\r\n      in_traffic_zone: isReverse ? props.item.in_traffic_zone : null,\r\n    }\r\n    return item\r\n  })\r\n  const { width } = dimensionsMixin({ containerRef })\r\n\r\n  return {\r\n    iconName,\r\n    width,\r\n    formattedItem,\r\n  }\r\n}\r\n","import { onUpdated, ref, watch, nextTick } from \"vue\"\r\nimport { DimensionsMixin } from \"./dimensions.mixin.model\"\r\n\r\nexport function dimensionsMixin({\r\n  containerRef\r\n}: DimensionsMixin) {\r\n\r\n  const width = ref(0)\r\n\r\n  watch(\r\n    () => containerRef.value?.clientWidth,\r\n    (nv) => {\r\n      if (nv) width.value = nv\r\n    }\r\n  )\r\n\r\n  const updateWidth = () => {\r\n    const initialWidth = containerRef.value?.clientWidth\r\n    if (initialWidth) width.value = initialWidth\r\n  }\r\n\r\n  onUpdated(() => {\r\n    nextTick(() => updateWidth())\r\n  })\r\n  return {\r\n    width\r\n  }\r\n}\r\n","<template>\r\n  <div ref=\"pointDetailsContainer\">\r\n    <img\r\n      v-if=\"\r\n        item &&\r\n        'type' in item &&\r\n        item.iconUrl &&\r\n        !item.iconUrl.endsWith('general.png')\r\n      \"\r\n      :src=\"\r\n        item?.iconUrl\r\n          .replace(markerUrls.search, markerUrls.colorSvg)\r\n          .replace('.png', '.svg')\r\n      \"\r\n      :width=\"width\"\r\n    />\r\n    <Icon\r\n      v-else\r\n      :name=\"iconName\"\r\n      :size=\"width\"\r\n      color=\"steelblue\"\r\n      :scale=\"false\"\r\n    ></Icon>\r\n    <div class=\"px-2 text-lg\">\r\n      <div v-if=\"formattedItem?.place\" class=\"d-flex align-center\">\r\n        <Icon name=\"marker\" :size=\"25\" color=\"steelblue\" class=\"px-1\"></Icon>\r\n        {{ formattedItem.place }}\r\n      </div>\r\n      <br />\r\n      <div v-if=\"formattedItem?.address\" class=\"d-flex align-center\">\r\n        <Icon name=\"secondary\" :size=\"25\" color=\"steelblue\" class=\"px-1\"></Icon>\r\n        {{ formattedItem.address }}\r\n      </div>\r\n      <br />\r\n      <div v-if=\"formattedItem?.neighbourhood\" class=\"d-flex align-center\">\r\n        <Icon\r\n          name=\"neighborhood_landmark\"\r\n          :size=\"25\"\r\n          color=\"steelblue\"\r\n          class=\"px-1\"\r\n        ></Icon>\r\n        {{ formattedItem.neighbourhood }}\r\n      </div>\r\n      <br />\r\n      <div v-if=\"formattedItem?.region\" class=\"d-flex align-center\">\r\n        <Icon name=\"city\" :size=\"25\" color=\"steelblue\" class=\"px-1\"></Icon>\r\n        {{ formattedItem.region }}\r\n      </div>\r\n      <br />\r\n      <div v-if=\"formattedItem?.in_odd_even_zone\" class=\"d-flex align-center\">\r\n        {{ formattedItem.in_odd_even_zone ? \"داخل\" : \"خارج از\" }}\r\n        محدوده طرح زوج و فرد\r\n      </div>\r\n      <br />\r\n      <div v-if=\"formattedItem?.in_traffic_zone\" class=\"d-flex align-center\">\r\n        {{ formattedItem.in_traffic_zone ? \"داخل\" : \"خارج از\" }}\r\n        محدوده طرح ترافیک\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, defineProps, PropType } from \"vue\"\r\nimport { detailsSectionMixin } from \"@/mixins\"\r\nimport Icon from \"@/components/icons/IconComponent.vue\"\r\nimport { SelectedMarker } from \"../../../store/markers/markers.model\"\r\nimport { markerUrls } from \"@/parameters/index\"\r\n\r\nconst props = defineProps({\r\n  item: Object as PropType<SelectedMarker>,\r\n  collapse: Boolean,\r\n})\r\n\r\nconst pointDetailsContainer = ref<HTMLDivElement>()\r\nconst { iconName, width, formattedItem } = detailsSectionMixin({\r\n  props,\r\n  containerRef: pointDetailsContainer,\r\n})\r\n</script>\r\n\r\n<style></style>\r\n","<template>\r\n  <div\r\n    :style=\"resultBoxStyle\"\r\n    :class=\"resultBoxClass\"\r\n    class=\"map-result-box mx-auto\"\r\n    ref=\"resultSection\"\r\n  >\r\n    <Loading\r\n      v-if=\"\r\n        store.getters.touchPlatform\r\n          ? store.state.searchLoading\r\n          : store.getters.loading\r\n      \"\r\n    />\r\n    <template\r\n      v-if=\"\r\n        !store.getters.touchPlatform &&\r\n        store.state.drawerShowDetails &&\r\n        store.state.selectedMarker\r\n      \"\r\n    >\r\n      <PointDetails :item=\"store.state.selectedMarker\" />\r\n    </template>\r\n    <template v-else>\r\n      <ResultItem\r\n        v-for=\"item in items\"\r\n        :key=\"'' + item.location.x + item.location.y\"\r\n        :item=\"item\"\r\n        @mouseenter=\"handleHoverEmit(item)\"\r\n        @click=\"emitClick(item)\"\r\n      />\r\n    </template>\r\n  </div>\r\n</template>\r\n<script setup lang=\"ts\">\r\nimport { defineProps, PropType, defineEmits, watch, ref, inject } from \"vue\"\r\n\r\nimport ResultItem from \"./ResultItem.vue\"\r\nimport Loading from \"@/components/LoadingComp.vue\"\r\nimport PointDetails from \"./PointDetails.vue\"\r\nimport { SearchItem } from \"../../../store/markers/markers.model\"\r\nimport { Store } from \"@/store/store.model\"\r\nconst props = defineProps({\r\n  resultBoxClass: Array,\r\n  resultBoxStyle: Object,\r\n  items: {\r\n    type: Array as PropType<SearchItem[]>,\r\n    default: () => [],\r\n  },\r\n})\r\n\r\nconst store = inject<Store>('store') as Store\r\n\r\nconst resultSection = ref<HTMLDivElement>()\r\n\r\nconst emits = defineEmits([\"result-hover\", \"result-click\"])\r\nconst handleHoverEmit = (item: SearchItem) => {\r\n  if (!store.getters.touchPlatform) {\r\n    emitHover(item)\r\n  }\r\n}\r\nconst emitHover = (item: SearchItem) => {\r\n  emits(\"result-hover\", item)\r\n}\r\nconst emitClick = (item: SearchItem) => {\r\n  emits(\"result-click\", item)\r\n}\r\n\r\nwatch(\r\n  () => store.state.drawerActivation,\r\n  (nv) => {\r\n    if (!nv) return\r\n    const style = store.getters.touchPlatform\r\n      ? `height: ${store.state.mapDimensions.height}; width: ${store.getters.drawerWidth}; ${props.resultBoxStyle}`\r\n      : `height: ${store.state.mapDimensions.height}; width: ${store.getters.drawerWidth}; ${props.resultBoxStyle}`\r\n    resultSection.value?.setAttribute(\"style\", style)\r\n  }\r\n)\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.map-result-box {\r\n  overflow: auto;\r\n  background: none;\r\n  transition: inherit;\r\n}\r\n\r\n/* width */\r\n::-webkit-scrollbar {\r\n  width: 0px;\r\n}\r\n\r\n/* Track */\r\n::-webkit-scrollbar-track {\r\n  background: #f1f1f1;\r\n}\r\n\r\n/* Handle */\r\n::-webkit-scrollbar-thumb {\r\n  background: #888;\r\n}\r\n\r\n/* Handle on hover */\r\n::-webkit-scrollbar-thumb:hover {\r\n  background: #555;\r\n}\r\n</style>\r\n","<template>\r\n  <div\r\n    :class=\"{\r\n      'map-drawer--mobile': store.getters.touchPlatform,\r\n      'map-drawer--desktop': !store.getters.touchPlatform,\r\n      'map-drawer--desktop---activated':\r\n        !store.getters.touchPlatform && store.state.drawerActivation,\r\n      'box-shadow': !store.state.drawerActivation,\r\n    }\"\r\n    class=\"d-flex flex-column\"\r\n    :activated=\"store.state.drawerActivation\"\r\n    ref=\"mapDrawer\"\r\n  >\r\n    <SearchSection\r\n      ref=\"searchSection\"\r\n      v-model:searchText=\"searchText\"\r\n      @submit=\"emitSearch({ term: $event })\"\r\n    ></SearchSection>\r\n    <ResultsSection\r\n      :items=\"items\"\r\n      @result-click=\"emitResultClick\"\r\n      @result-hover=\"emitResultHover\"\r\n    ></ResultsSection>\r\n  </div>\r\n</template>\r\n<script setup lang=\"ts\">\r\nimport { ref, defineProps, PropType, defineEmits, onMounted, watch, inject } from \"vue\"\r\nimport { HandleSearchProps } from \"../Map.model\"\r\nimport SearchSection from \"./SearchSection.vue\"\r\nimport ResultsSection from \"./result-section/ResultsSection.vue\"\r\nimport { SearchItem } from \"../../store/markers/markers.model\"\r\nimport { Store } from \"@/store/store.model\"\r\n\r\ndefineProps({\r\n  items: Array as PropType<SearchItem[]>,\r\n  loading: Boolean,\r\n})\r\n\r\nconst store = inject<Store>('store') as Store\r\n\r\nconst searchText = ref(\"\")\r\nconst emits = defineEmits([\"search\", \"result-click\", \"result-hover\"])\r\n\r\nconst emitSearch = (searchData: HandleSearchProps) => {\r\n  const data = {\r\n    term: searchData.term || \"\",\r\n  }\r\n  emits(\"search\", data)\r\n}\r\n\r\nconst emitResultClick = (item: SearchItem) => {\r\n  emits(\"result-click\", item)\r\n}\r\nconst emitResultHover = (item: SearchItem) => {\r\n  emits(\"result-hover\", item)\r\n}\r\n\r\nconst mapDrawer = ref<HTMLDivElement>()\r\nconst searchSection = ref()\r\n/**\r\n * Changes drawer max-height & max-width according to whether its activated or not\r\n * between 100% and search section dimenstions\r\n * @param activated - whether the drawer is activated or not\r\n */\r\nconst toggleDrawerMaxDimenstions = (activated: boolean) => {\r\n  if (!searchSection.value || !mapDrawer.value) return\r\n  if (!activated) {\r\n    const height = searchSection.value.$el.clientHeight\r\n    const width = searchSection.value.$el.clientWidth\r\n    mapDrawer.value.style.setProperty(\"max-height\", `${height}px`)\r\n    mapDrawer.value.style.setProperty(\"max-width\", `${width}px`)\r\n  } else {\r\n    mapDrawer.value.style.setProperty(\"max-height\", \"100%\")\r\n    mapDrawer.value.style.setProperty(\"max-width\", \"100%\")\r\n  }\r\n}\r\nwatch(\r\n  () => store.state.drawerActivation,\r\n  (nv) => {\r\n    toggleDrawerMaxDimenstions(nv)\r\n  }\r\n)\r\nonMounted(() => {\r\n  toggleDrawerMaxDimenstions(store.state.drawerActivation)\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.map-drawer--desktop {\r\n  position: absolute;\r\n  z-index: 2;\r\n  top: 5%;\r\n  background-color: white;\r\n  right: 2%;\r\n  transition: 0.6s;\r\n  max-width: min-content;\r\n  border-radius: 0.7em;\r\n  overflow: hidden;\r\n  &[activated=\"true\"] {\r\n    top: 0;\r\n    right: 0;\r\n    max-height: 100%;\r\n    border-radius: 0;\r\n    padding-right: 1em;\r\n    padding-left: 1em;\r\n  }\r\n}\r\n\r\n.map-drawer--desktop---activated {\r\n  box-shadow: 0 4px 25px rgb(0 0 0 / 25%);\r\n}\r\n\r\n.map-drawer--mobile {\r\n  position: absolute;\r\n  z-index: 2;\r\n  top: 5%;\r\n  background-color: white;\r\n  right: 50%;\r\n  transform: translateX(50%);\r\n  transition: 0.6s;\r\n  max-width: min-content;\r\n  border-radius: 0.7em;\r\n  overflow: hidden;\r\n  &[activated=\"true\"] {\r\n    top: 0;\r\n    max-height: 100%;\r\n    max-width: 100%;\r\n    border-radius: 0;\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <div\r\n    ref=\"mobileDetailsSectionContainer\"\r\n    class=\"mobile-details-section pos-absolute\"\r\n    :class=\"{ fullScreen }\"\r\n  >\r\n    <button\r\n      class=\"close-modal-button pos-absolute d-flex justify-center align-center\"\r\n      @click=\"hideModal\"\r\n    >\r\n      <Icon :size=\"25\"></Icon>\r\n    </button>\r\n    <div\r\n      ref=\"detailsContainer\"\r\n      :class=\"fullScreen ? 'o-auto' : 'o-hidden'\"\r\n      :style=\"`\r\n        max-height: ${detailsContainerMaxHeight};\r\n        border-radius: ${detailsContainerBorderRadius};\r\n        transition: ${detailsContainerTransition};`\"\r\n    >\r\n      <Loading v-show=\"store.state.reverseLoading\" class=\"curved-loading\" />\r\n      <Icon\r\n        name=\"close\"\r\n        :size=\"40\"\r\n        :style=\"`visibility: ${fullScreen ? 'visible' : 'hidden'};`\"\r\n        class=\"close-icon pos-absolute\"\r\n        @click=\"closeScreen\"\r\n      ></Icon>\r\n      <span\r\n        class=\"drag-button d-block pos-absolute\"\r\n        :style=\"`padding-top: calc(${drawerConstants.bottomSheetloadingHeight}/2)`\"\r\n        @touchmove=\"handleTouchMove\"\r\n        @touchend=\"handleTouchEnd\"\r\n      >\r\n        <span class=\"d-block\" />\r\n      </span>\r\n      <div\r\n        :style=\"`\r\n      height: ${store.state.mapDimensions.height}px;\r\n      margin-top: ${drawerConstants.bottomSheetloadingHeight};`\"\r\n      >\r\n        <PointDetails :item=\"store.state.selectedMarker\"></PointDetails>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script setup lang=\"ts\">\r\nimport { inject, ref, watch } from \"vue\"\r\nimport { drawerConstants } from \"@/parameters\"\r\nimport type { Store } from '@/store/store.model'\r\n\r\nimport Icon from \"@/components/icons/IconComponent.vue\"\r\nimport PointDetails from \"./drawer/result-section/PointDetails.vue\"\r\nimport Loading from \"./LoadingComp.vue\"\r\n\r\nconst store = inject<Store>('store') as Store\r\n\r\nconst mobileDetailsSectionContainer = ref<HTMLDivElement>()\r\nconst detailsContainer = ref<HTMLDivElement>()\r\nconst fullScreen = ref(false)\r\nconst detailsContainerMaxHeight = ref(drawerConstants.bottomSheetNormalHeight)\r\nconst detailsContainerBorderRadius = ref(\r\n  drawerConstants.bottomSheetBorderRadius\r\n)\r\nconst detailsContainerTransition = ref(\"0\")\r\n\r\nconst handleTouchMove = (evt: TouchEvent) => {\r\n  evt.preventDefault()\r\n  if (!mobileDetailsSectionContainer.value || !store.state.mapContainer) return\r\n  const mapClientBottom =\r\n    store.state.mapContainer.getBoundingClientRect().bottom\r\n  const additionalHeight = mapClientBottom - evt.touches[0].clientY\r\n  detailsContainerMaxHeight.value = additionalHeight + \"px\"\r\n}\r\n\r\nconst handleTouchEnd = () => {\r\n  if (!detailsContainer.value) return\r\n  addTemporaryTransition()\r\n  const maxHeight = detailsContainerMaxHeight.value\r\n  const currentHeight = Number(maxHeight.slice(0, maxHeight.length - 2))\r\n  const mapHeight = Number(\r\n    store.state.mapDimensions.height.slice(\r\n      0,\r\n      store.state.mapDimensions.height.length - 2\r\n    )\r\n  )\r\n  if (fullScreen.value) {\r\n    if (currentHeight < mapHeight * 0.8) {\r\n      closeScreen()\r\n    } else {\r\n      detailsContainerMaxHeight.value = store.state.mapDimensions.height\r\n    }\r\n  } else {\r\n    if (currentHeight > mapHeight / 4) {\r\n      detailsContainerMaxHeight.value = `calc(${store.state.mapDimensions.height})`\r\n      detailsContainerBorderRadius.value = \"0\"\r\n      fullScreen.value = true\r\n    } else {\r\n      detailsContainerMaxHeight.value = drawerConstants.bottomSheetNormalHeight\r\n    }\r\n  }\r\n}\r\n\r\nconst closeScreen = () => {\r\n  fullScreen.value = false\r\n  addTemporaryTransition()\r\n  detailsContainerBorderRadius.value = drawerConstants.bottomSheetBorderRadius\r\n  detailsContainerMaxHeight.value = drawerConstants.bottomSheetNormalHeight\r\n}\r\n\r\nlet timeout: number\r\nconst addTemporaryTransition = (transitionTime = 0.5) => {\r\n  clearTimeout(timeout)\r\n  detailsContainerTransition.value = transitionTime + \"s\"\r\n  timeout = setTimeout(() => {\r\n    detailsContainerTransition.value = \"none\"\r\n  }, transitionTime * 1000)\r\n}\r\n\r\nconst hideModal = () => {\r\n  store.actions.markers.deselectAll()\r\n}\r\n\r\nconst collapseSheet = () => {\r\n  detailsContainerMaxHeight.value = drawerConstants.bottomSheetloadingHeight\r\n}\r\n\r\nconst openSheet = () => {\r\n  detailsContainerMaxHeight.value = drawerConstants.bottomSheetNormalHeight\r\n}\r\n\r\nwatch(\r\n  () => store.state.reverseLoading,\r\n  (nv) => {\r\n    addTemporaryTransition(0.2)\r\n    if (nv) {\r\n      collapseSheet()\r\n    } else if (!fullScreen.value) {\r\n      openSheet()\r\n    }\r\n  }\r\n)\r\n\r\nwatch(\r\n  () => store.state.selectedMarker,\r\n  (nv) => {\r\n    if (!nv) return\r\n    addTemporaryTransition(0.4)\r\n    collapseSheet()\r\n    setTimeout(() => {\r\n      openSheet()\r\n    }, 200)\r\n  }\r\n)\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.mobile-details-section {\r\n  width: 100%;\r\n  z-index: 1000000;\r\n  bottom: 0;\r\n  direction: rtl;\r\n  background-color: white;\r\n  border-radius: 1em 1em 0 0;\r\n  &.fullScreen {\r\n    border-radius: 0;\r\n  }\r\n  .curved-loading {\r\n    width: 100%;\r\n    border-radius: 1em 1em 0 0;\r\n  }\r\n  .close-icon {\r\n    left: 1em;\r\n    top: 1em;\r\n    z-index: 2;\r\n  }\r\n  .drag-button {\r\n    padding-bottom: 4em;\r\n    padding-left: 1.5em;\r\n    padding-right: 1.5em;\r\n    top: 0;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    width: 100%;\r\n    box-sizing: border-box;\r\n    & > span {\r\n      background-color: #cecece;\r\n      border-radius: 25px;\r\n      height: 5px;\r\n      width: 30px;\r\n      margin: auto;\r\n    }\r\n  }\r\n  .close-modal-button {\r\n    top: calc(-2em - 20px);\r\n    right: 1em;\r\n    z-index: 2;\r\n    background-color: white;\r\n    border: none;\r\n    border-radius: 50%;\r\n    height: 40px;\r\n    width: 40px;\r\n    box-shadow: 0 3px 10px rgb(0 0 0 / 20%);\r\n  }\r\n}\r\n</style>\r\n","declare const ol: any // eslint-disable-line\r\nimport { urls } from \"../parameters\"\r\nimport { Api, CreateApiOptions } from \"./apis.model\"\r\n\r\nexport const createHeaders = (token?: string) => {\r\n  return {\r\n    \"Api-Key\": token,\r\n  }\r\n}\r\nexport const createApi = (token?: string, options?: CreateApiOptions): Api => {\r\n  const requestOptions = {\r\n    headers: createHeaders(token),\r\n  }\r\n  const reverseReqOptions = !options?.reverseUrl ? requestOptions : {}\r\n  const searchReqOptions = !options?.searchUrl ? requestOptions : {}\r\n  return {\r\n    REVERSE: async (lng, lat) => {\r\n      const params = `?lat=${lat}&lng=${lng}`\r\n      const url = (options?.reverseUrl || urls.reverse) + params\r\n      const res = await fetch(url, reverseReqOptions)\r\n      return await res.json()\r\n    },\r\n    SEARCH: async (term, [lng, lat]) => {\r\n      const params = `?term=${term}&lat=${lat}&lng=${lng}`\r\n      const url = (options?.searchUrl || urls.search) + params\r\n      const res = await fetch(url, searchReqOptions)\r\n      return await res.json()\r\n    },\r\n  }\r\n}\r\n","import { breakpointsSegments, unsetMapDimnensions } from \"@/parameters\"\r\n\r\nconst stateGen = () => {\r\n  return {\r\n    breakpoints: {\r\n      ...breakpointsSegments,\r\n      lt: { ...breakpointsSegments },\r\n      gt: { ...breakpointsSegments },\r\n    },\r\n    mapDimensions: unsetMapDimnensions,\r\n  }\r\n}\r\n\r\nexport const dimenstionsState = stateGen()\r\n","import { VectorLayer } from \"../../components/Map.model\"\r\nimport { Coordinate } from \"openlayers\"\r\nimport { ReverseResult, SearchItem, SelectedMarker } from \"./markers.model\"\r\n\r\nconst stateGen = () => {\r\n  return {\r\n    selectedMarker: null as SelectedMarker,\r\n    mainMarker: null as VectorLayer | null,\r\n    mainMarkerCoords: null as Coordinate | null,\r\n    reverseResult: null as ReverseResult | null,\r\n    searchMarkers: null as VectorLayer | null,\r\n    searchResults: [] as SearchItem[],\r\n  }\r\n}\r\n\r\nexport const markersState = stateGen()\r\n","import { Overlay } from \"./overlays.model\"\r\n\r\nconst stateGen = () => {\r\n  return {\r\n    overlay: null as Overlay | null,\r\n    persistentOverlay: null as Overlay | null,\r\n    popupContainer: null as HTMLDivElement | null,\r\n    persistentContainer: null as HTMLDivElement | null,\r\n  }\r\n}\r\n\r\nexport const overlayState = stateGen()\r\n","const stateGen = () => {\r\n  return {\r\n    drawerActivation: false,\r\n    drawerShowDetails: false,\r\n    mobileDrawerShowDetails: false,\r\n  }\r\n}\r\n\r\nexport const drawersState = stateGen()\r\n","import { MapType, OlMap, ViewType } from \"./map.model\"\r\nimport { zoomConstants } from \"@/parameters\"\r\n\r\nconst stateGen = () => {\r\n  return {\r\n    mapContainer: null as HTMLDivElement | null,\r\n    map: null as OlMap | null,\r\n    mapType: \"neshan\" as MapType,\r\n    zoom: zoomConstants.initialZoom,\r\n    poiLayer: true,\r\n    trafficLayer: true,\r\n    viewType: 'desktop' as ViewType,\r\n    scale: 1\r\n  }\r\n}\r\n\r\nexport const mapState = stateGen()\r\n","import { reactive } from \"vue\"\r\nimport { dimenstionsState } from \"./dimensions/state\"\r\nimport { markersState } from \"./markers/state\"\r\nimport { overlayState } from \"./overlays/state\"\r\nimport { drawersState } from \"./drawers/state\"\r\nimport { mapState } from \"./map/state\"\r\nimport { State } from \"./store.model\"\r\nimport { Api } from \"@/apis/apis.model\"\r\n\r\nexport const state = {\r\n  ...dimenstionsState,\r\n  ...markersState,\r\n  ...overlayState,\r\n  ...drawersState,\r\n  ...mapState,\r\n  api: null as Api | null,\r\n  searchLoading: false,\r\n  reverseLoading: false,\r\n}\r\n\r\nexport const stateGenerator = () => {\r\n  return reactive(<State>JSON.parse(JSON.stringify(state)))\r\n}\r\n","import { computed, reactive } from \"vue\"\r\nimport { drawerConstants } from \"@/parameters\"\r\nimport { isTouchPlatform } from \"@/utils\"\r\nimport { State } from \"./store.model\"\r\nexport const getters = (state: State) =>\r\n  reactive({\r\n    drawerWidth: computed(() => {\r\n      const isMobile = state.viewType ? state.viewType === 'mobile' : isTouchPlatform()\r\n      const width = isMobile\r\n        ? state.mapDimensions.width\r\n        : drawerConstants.width\r\n      return width\r\n    }),\r\n    loading: computed(() => {\r\n      return state.searchLoading || state.reverseLoading\r\n    }),\r\n    touchPlatform: computed(() => {\r\n      return state.viewType ? state.viewType === 'mobile' : isTouchPlatform()\r\n    }),\r\n  })\r\n","import { VectorLayer } from \"../../components/Map.model\"\r\nimport {\r\n  AddMarkers,\r\n  GetClusterByCoords,\r\n  GetMarkerByCoords,\r\n  GetSearchResultByFeature,\r\n  ReverseOnPointOptions,\r\n  ReverseResult,\r\n  SearchItem,\r\n  SearchOptions,\r\n  SearchProps,\r\n  SelectFeautureOptions,\r\n  ZoomToExtentOptions,\r\n} from \"./markers.model\"\r\nimport {\r\n  createClusterSource,\r\n  createMapPoints,\r\n  createMarkers,\r\n  getClusterExtent,\r\n  getCoordsFromFeature,\r\n  getFeatureExtent,\r\n  getTitleFromData,\r\n  transformCoords,\r\n} from \"@/utils\"\r\nimport { Coordinate, Extent, Feature, MapBrowserEvent } from \"openlayers\"\r\nimport { markersOffset, markerUrls, zoomConstants } from \"@/parameters\"\r\nimport { Context } from \"../store.model\"\r\n\r\n/**\r\n * Receives an array of points and marks them on map.\r\n * @param points - Array of points.\r\n * @param point.coords - Coordinates of that point.\r\n * @param point.text - If you have a particular text for the point.\r\n * @param point.style - If you have a particular style for that point (only checks the first point for now).\r\n * @param point.color - If you have a particular color for that point (only checks the first point for now).\r\n * @param point.image - If you have a particular image for that point (only checks the first point for now).\r\n * @param point.iconScale - If you have a particular icon scale for that point (only checks the first point for now).\r\n * @param point.originalItem - original item from neshan search result\r\n * @param point.props - props to set for point feature\r\n * @param options.cluster - If these markers need to be clusterd on given zoom number\r\n * @param options.clusterThreshold - Zoom number that markers should be clusterd on zoom condition above that given zoom\r\n * @param options.showPopup - If you want show the text as popup\r\n * @param options.props - Props to set for all features\r\n * @returns style and layer.\r\n */\r\nconst addMarkers: AddMarkers = ({ state }, points, options) => {\r\n  const { layer, style } = createMarkers(points, options)\r\n  state.map?.addLayer(layer)\r\n  return { layer, style }\r\n}\r\n\r\n/**\r\n * Toggles cluster source to deactivate or apply clustering (The layer will remain a cluster layer)\r\n * @param layer\r\n * @param deactivate - whether to deactivate clustering or apply it.\r\n */\r\nconst toggleClusterSource = (\r\n  context: Context,\r\n  layer: VectorLayer,\r\n  deactivate: boolean\r\n) => {\r\n  if (!layer) return\r\n  const clusterFeatures = layer.getSource().getFeatures() || []\r\n  if (!clusterFeatures.some((cf) => cf.get(\"isCluster\"))) return\r\n  const features = clusterFeatures.reduce((result: Feature[], cf) => {\r\n    const features: Feature[] = cf.get(\"features\")\r\n    return [...result, ...features]\r\n  }, [])\r\n  const newDistance = deactivate ? 0 : 30\r\n  const newSource = createClusterSource(features, {\r\n    distance: newDistance,\r\n    minDistance: newDistance,\r\n  })\r\n  layer.setSource(newSource)\r\n}\r\n\r\n/**\r\n * Takes the title of a marker and returns the found cluster and its surrounding cluster\r\n * @param coords - Coorinates of wanted feature\r\n * @returns The found feature and its cluster\r\n */\r\nconst getClusterByCoords: GetClusterByCoords = (context, coords) => {\r\n  const clusters = context.state.searchMarkers?.getSource().getFeatures()\r\n  let foundFeature: Feature | undefined\r\n  const cluster = clusters?.find((cluster) => {\r\n    const feature = getMarkerInClusterByCoords(context, cluster, coords)\r\n    if (feature) {\r\n      foundFeature = feature\r\n    }\r\n    return feature\r\n  })\r\n  return {\r\n    feature: foundFeature,\r\n    cluster,\r\n  }\r\n}\r\n\r\n/**\r\n * Take a cluster and a title and returns the feature inside the cluster by its title\r\n * @param cluster - The cluster we are looking for feature in it\r\n * @param coords - Coordinate of wanted feature\r\n * @returns The found feature\r\n */\r\nconst getMarkerInClusterByCoords = (\r\n  context: Context,\r\n  cluster: Feature,\r\n  coords: Coordinate\r\n) => {\r\n  const features: Feature[] | undefined = cluster.get(\"features\")\r\n  return features?.find((feat) => feat.getId() === coords.join(\"-\"))\r\n}\r\n\r\n/**\r\n * Takes the title of a marker and returns it.\r\n * @param coords - Coordinate of wanted feature\r\n * @returns The found marker\r\n */\r\nconst getMarkerByCoords: GetMarkerByCoords = ({ state }, coords) => {\r\n  return state.searchMarkers?.getSource().getFeatureById(coords.join(\"-\"))\r\n}\r\n\r\n/**\r\n * Takes a feature and returns its relating search item\r\n * @param feature\r\n * @returns Search Item\r\n */\r\nconst getSearchResultByFeature: GetSearchResultByFeature = (\r\n  { state },\r\n  feature\r\n) => {\r\n  const title = feature.get(\"text\")\r\n  return state.searchResults.find(\r\n    (si) => si.title === (Array.isArray(title) ? title[0] : title)\r\n  )\r\n}\r\n\r\n/**\r\n * Take the layer and zooms on its features\r\n * @param layer\r\n * @param options.duration - Zooming duration\r\n */\r\nconst zoomToLayer = (\r\n  context: Context,\r\n  layer: VectorLayer,\r\n  options?: ZoomToExtentOptions\r\n) => {\r\n  const extent: Extent = layer.getSource().getExtent()\r\n  zoomToExtent(context, extent, options)\r\n}\r\n\r\n/**\r\n * Gets the desired extent and zooms on it\r\n * @param extent - Extent of the area to zoom on\r\n * @param options.duration - Zooming duration\r\n */\r\nconst zoomToExtent = (\r\n  { state, getters }: Context,\r\n  extent: Extent,\r\n  options?: ZoomToExtentOptions\r\n) => {\r\n  const duration = options?.duration || 500\r\n  state.map?.getView().fit(extent, {\r\n    size: state.map.getSize(),\r\n    duration,\r\n    maxZoom:\r\n      state.zoom > zoomConstants.maxZoom ? state.zoom : zoomConstants.maxZoom,\r\n    padding: [15, getters.touchPlatform ? 15 : 300, 15, 15],\r\n  })\r\n}\r\n\r\n/**\r\n * Takes the marker and zooms on it\r\n * @param marker\r\n * @param options.duration - Zooming duration\r\n */\r\nconst zoomToMarker = (\r\n  context: Context,\r\n  marker: Feature,\r\n  options?: ZoomToExtentOptions\r\n) => {\r\n  const extent = getFeatureExtent(marker)\r\n  zoomToExtent(context, extent, options)\r\n}\r\n\r\n/**\r\n * Takes the cluster and zooms on it\r\n * @param cluster\r\n * @param options.duration - Zooming duration\r\n */\r\nconst zoomToCluster = (\r\n  context: Context,\r\n  cluster: Feature,\r\n  options?: ZoomToExtentOptions\r\n) => {\r\n  const extent = getClusterExtent(cluster)\r\n  zoomToExtent(context, extent, options)\r\n}\r\n\r\n/**\r\n * Takes the coordinates and zooms on it\r\n * @param coords\r\n * @param options.duration - Zooming duration\r\n */\r\nconst zoomToCoords = (\r\n  context: Context,\r\n  coords: Coordinate,\r\n  options?: ZoomToExtentOptions\r\n) => {\r\n  const extent: Extent = [...coords, ...coords]\r\n  zoomToExtent(context, extent, options)\r\n}\r\n\r\n/**\r\n * Zooms on given feature and shows its details on detail section\r\n * Adds a persistent overlay on it\r\n * @param feature\r\n * @param options\r\n */\r\nconst selectFeauture = (\r\n  context: Context,\r\n  feature: Feature | SearchItem | ReverseResult,\r\n  options?: SelectFeautureOptions\r\n) => {\r\n  let isMainMarker = false\r\n  let coords = <Coordinate>options?.coords\r\n  let text = <string>options?.text\r\n  if (\"mapCoords\" in feature) {\r\n    coords ||= feature.mapCoords\r\n    zoomToCoords(context, coords)\r\n    if (\"title\" in feature) {\r\n      text = feature.title\r\n    } else {\r\n      isMainMarker = true\r\n      text = getTitleFromData(feature)\r\n    }\r\n  } else {\r\n    zoomToMarker(context, feature)\r\n    coords ||= getCoordsFromFeature(feature)\r\n    isMainMarker = feature?.getProperties().mainMarker\r\n    text ||= feature.getProperties().text\r\n    if (Array.isArray(text)) text = text[0]\r\n  }\r\n  if (options?.delay !== 0) {\r\n    setTimeout(() => {\r\n      context.actions.overlays.changeOverlayStats(\r\n        context,\r\n        {\r\n          coords,\r\n          text,\r\n          offset: isMainMarker ? markersOffset.high : markersOffset.short,\r\n        },\r\n        \"persistent\"\r\n      )\r\n    }, options?.delay || 500)\r\n  } else {\r\n    context.actions.overlays.changeOverlayStats(\r\n      context,\r\n      {\r\n        coords,\r\n        text,\r\n        offset: isMainMarker ? markersOffset.high : markersOffset.short,\r\n      },\r\n      \"persistent\"\r\n    )\r\n  }\r\n  const foundResult = isMainMarker\r\n    ? context.state.reverseResult\r\n    : !(\"mapCoords\" in feature)\r\n    ? context.actions.markers.getSearchResultByFeature(context, feature)\r\n    : feature\r\n  if (foundResult) {\r\n    context.state.selectedMarker = foundResult\r\n    context.actions.drawers.toggleResultDrawers(context, true)\r\n  }\r\n}\r\n\r\n/**\r\n * Removes persistent overlay and marker layer from the map.\r\n * Deactivates drawers and clears selected marker\r\n */\r\nconst deselectAll = (context: Context) => {\r\n  context.actions.overlays.changeOverlayStats(context, undefined, \"persistent\")\r\n  if (context.state.mainMarker)\r\n    context.state.map?.removeLayer(context.state.mainMarker)\r\n  context.state.selectedMarker = null\r\n  context.actions.drawers.toggleResultDrawers(context, false)\r\n}\r\n\r\n/**\r\n * Looks for features in current hover or click event of map\r\n * @param evt - Map hover or click event\r\n * @returns feature (If found)\r\n */\r\nconst getFeatureFromEvent = (context: Context, evt: MapBrowserEvent) => {\r\n  return <Feature | undefined>(\r\n    context.state.map?.forEachFeatureAtPixel(evt.pixel, (feature) => feature)\r\n  )\r\n}\r\n/**\r\n * Places a marker on a point on ol map\r\n * Sends a reverse request on that position\r\n * and adds a title based on returned value\r\n * @param coords - OL Coords\r\n * @param options.useMarker - Whether to put marker on locating area or not\r\n * @returns marker, standard coords of point and api result data\r\n */\r\nconst reverseOnPoint = async (\r\n  context: Context,\r\n  coords: Coordinate,\r\n  {\r\n    useMarker = true,\r\n    usePopup = true,\r\n    customText,\r\n    markersIconCallback,\r\n  }: ReverseOnPointOptions = {}\r\n) => {\r\n  try {\r\n    context.state.reverseLoading = true\r\n    const mapCoords = transformCoords(coords, \"EPSG:4326\", \"EPSG:3857\")\r\n    if (context.getters.touchPlatform)\r\n      context.state.mobileDrawerShowDetails = true\r\n    else context.state.drawerActivation = true\r\n    let marker: VectorLayer | null = null\r\n    if (useMarker) {\r\n      const { layer } = context.actions.markers.addMarkers(\r\n        context,\r\n        [\r\n          {\r\n            coords: mapCoords,\r\n            text: \"\",\r\n            iconScale: 0.1,\r\n            iconUrl: markerUrls.main,\r\n            isReverseMarker: true,\r\n          },\r\n        ],\r\n        {\r\n          markersIconCallback,\r\n          props: {\r\n            isCluster: false,\r\n          },\r\n          anchor: [0.5, 1],\r\n        }\r\n      )\r\n      context.state.mainMarkerCoords = coords\r\n      context.state.mainMarker = layer\r\n      marker = layer\r\n    }\r\n    if (!context.state.api) throw \"No reverse api\"\r\n    const data = await context.state.api.REVERSE(...coords)\r\n    const extendedData = {\r\n      ...data,\r\n      mapCoords: coords,\r\n    }\r\n    context.state.selectedMarker = extendedData\r\n    context.state.reverseResult = extendedData\r\n    context.actions.drawers.toggleResultDrawers(context, true)\r\n    const text = customText || getTitleFromData(extendedData)\r\n    context.state.mainMarker?.getSource().getFeatures()[0].set(\"text\", text)\r\n    if (usePopup) {\r\n      context.actions.overlays.changeOverlayStats(\r\n        context,\r\n        { coords: mapCoords, text, offset: markersOffset.high },\r\n        \"persistent\"\r\n      )\r\n    }\r\n    return { marker, coords, data }\r\n  } catch (error) {\r\n    console.log(error)\r\n    return {}\r\n  } finally {\r\n    context.state.reverseLoading = false\r\n  }\r\n}\r\n\r\n/**\r\n * Does a neshan search based on given parameters\r\n * @param searchParams.text - Part of or whole name of the place.\r\n * @param searchParams.coords - Coordinates you want to search around.\r\n */\r\nconst search = async (\r\n  context: Context,\r\n  { term = \"\", coords }: SearchProps,\r\n  options?: SearchOptions\r\n) => {\r\n  try {\r\n    context.state.searchLoading = true\r\n    if (!context.state.api) return\r\n    const result = await context.state.api.SEARCH(term, coords)\r\n    context.state.drawerShowDetails = false\r\n    if (context.state.searchMarkers)\r\n      context.state.map?.removeLayer(context.state.searchMarkers)\r\n    const points = await createMapPoints(result.items)\r\n    const resultsWithMapCoords = points.map((point) => ({\r\n      ...point.originalItem,\r\n      iconUrl: point.iconUrl,\r\n      mapCoords: point.coords,\r\n    }))\r\n    context.state.searchResults = resultsWithMapCoords\r\n    const { layer } = context.actions.markers.addMarkers(context, points, {\r\n      markersIconCallback: options?.markersIconCallback,\r\n      cluster: options?.cluster,\r\n      clusterThreshold: options?.clusterThreshold,\r\n    })\r\n    context.actions.overlays.changeOverlayStats(\r\n      context,\r\n      undefined,\r\n      \"persistent\"\r\n    )\r\n    context.state.searchMarkers = layer\r\n    // Apparently it takse some async time to cluster the source\r\n    setTimeout(() => {\r\n      const features = layer.getSource().getFeatures()\r\n      //To fix a problem with zooming on single feature layers extent\r\n      if (features.length === 1) {\r\n        context.actions.markers.zoomToCluster(context, features[0], {\r\n          duration: 1500,\r\n        })\r\n      } else {\r\n        context.actions.markers.zoomToLayer(context, layer, { duration: 1500 })\r\n      }\r\n    }, 200)\r\n    return {\r\n      markers: layer,\r\n      data: result,\r\n    }\r\n  } catch (error) {\r\n    console.log(error)\r\n  } finally {\r\n    context.state.searchLoading = false\r\n  }\r\n}\r\n\r\nexport const markersActions = {\r\n  addMarkers,\r\n  toggleClusterSource,\r\n  getClusterByCoords,\r\n  getMarkerInClusterByCoords,\r\n  getMarkerByCoords,\r\n  getSearchResultByFeature,\r\n  zoomToLayer,\r\n  zoomToExtent,\r\n  zoomToCoords,\r\n  zoomToMarker,\r\n  zoomToCluster,\r\n  selectFeauture,\r\n  deselectAll,\r\n  getFeatureFromEvent,\r\n  reverseOnPoint,\r\n  search,\r\n}\r\n","import { breakpointsSegments, breakpointsSegmentsPixels } from \"@/parameters\"\r\nimport { toRaw } from \"vue\"\r\nimport { BreakPoints, BreakpointsSegments } from \"./dimensions.model\"\r\nimport { Context } from \"../store.model\"\r\n\r\n/**\r\n * Updates map width & height values on window resize\r\n */\r\nconst updateMapDimensions = (context: Context) => {\r\n  if (!context.state.mapContainer) return\r\n  context.state.mapDimensions = {\r\n    height: context.state.mapContainer.clientHeight + \"px\",\r\n    width: context.state.mapContainer.clientWidth + \"px\",\r\n  }\r\n}\r\n\r\n/**\r\n * Updates store breakpoints on windows resize\r\n */\r\nconst updateBreakpoints = (context: Context) => {\r\n  const width = window.innerWidth\r\n  const keys = <(keyof BreakpointsSegments)[]>Object.keys(breakpointsSegments)\r\n  const newBreakpoints: BreakPoints = JSON.parse(\r\n    JSON.stringify(toRaw(context.state.breakpoints))\r\n  )\r\n  keys.forEach((brp, i) => {\r\n    const nextBrp = keys[i + 1]\r\n    if (width >= breakpointsSegmentsPixels[brp]) {\r\n      newBreakpoints.lt[brp] = false\r\n      if (!nextBrp || width < breakpointsSegmentsPixels[nextBrp]) {\r\n        newBreakpoints[brp] = true\r\n        newBreakpoints.gt[brp] = false\r\n      } else {\r\n        newBreakpoints[brp] = false\r\n        newBreakpoints.gt[brp] = true\r\n      }\r\n    } else if (width < breakpointsSegmentsPixels[brp]) {\r\n      newBreakpoints.lt[brp] = true\r\n      newBreakpoints.gt[brp] = false\r\n    }\r\n  })\r\n  context.state.breakpoints = newBreakpoints\r\n}\r\n\r\nexport const dimensionsActions = {\r\n  updateMapDimensions,\r\n  updateBreakpoints,\r\n}\r\n","import { Overlay } from \"openlayers\"\r\nimport { ChangeOverlayStats } from \"./overlays.model\"\r\nimport { markersOffset } from \"@/parameters\"\r\nimport { Context } from \"../store.model\"\r\n\r\ndeclare const ol: any\r\n\r\n/**\r\n * Sets up overlay on map\r\n */\r\nconst setupOverlays = (context: Context) => {\r\n  if (!context.state.popupContainer || !context.state.persistentContainer)\r\n    return\r\n  const overlay = createOverlay(context, context.state.popupContainer)\r\n  context.state.overlay = overlay\r\n  const persistentOverlay = createOverlay(\r\n    context,\r\n    context.state.persistentContainer,\r\n    true\r\n  )\r\n  context.state.persistentOverlay = persistentOverlay\r\n  context.state.map?.addOverlay(overlay)\r\n  context.state.map?.addOverlay(persistentOverlay)\r\n}\r\n\r\n/**\r\n * Changes overlay coords and text\r\n * @param stats.coords\r\n * @param stats.text\r\n * @param target - Whether to manipulated temporary or persistent overlay stats\r\n */\r\nconst changeOverlayStats: ChangeOverlayStats = (\r\n  context,\r\n  stats,\r\n  target = \"temporary\"\r\n) => {\r\n  const targetContainer =\r\n    target === \"temporary\"\r\n      ? context.state.popupContainer\r\n      : context.state.persistentContainer\r\n  const targetOverlay =\r\n    target === \"temporary\"\r\n      ? context.state.overlay\r\n      : context.state.persistentOverlay\r\n  if (!targetContainer) return\r\n  if (stats) {\r\n    const { coords, text, offset } = stats\r\n    targetContainer.innerHTML = text\r\n    if (offset) {\r\n      targetOverlay?.setOffset(offset)\r\n    }\r\n    targetOverlay?.setPosition(coords)\r\n  } else {\r\n    targetOverlay?.setPosition(undefined)\r\n  }\r\n}\r\n\r\n/**\r\n * Creates an ol overlay on container element\r\n * @param persistent - Whether it should not disappear on mouse leaving\r\n * @returns overlay\r\n */\r\nconst createOverlay = (\r\n  context: Context,\r\n  container: HTMLDivElement,\r\n  persistent = false\r\n) => {\r\n  const overlay: Overlay = new ol.Overlay({\r\n    element: container,\r\n    map: context.state.map,\r\n    positioning: \"top-center\",\r\n    offset: markersOffset.short,\r\n  })\r\n  overlay.set(\"persistent\", persistent) // An attr to know that we should remove it on following hovers\r\n  return overlay\r\n}\r\n\r\nexport const overlaysActions = {\r\n  setupOverlays,\r\n  createOverlay,\r\n  changeOverlayStats,\r\n}\r\n","import { Context } from \"../store.model\"\r\n\r\n/**\r\n * Toggles result view drawers based on screen\r\n */\r\nconst toggleResultDrawers = (\r\n  context: Context,\r\n  value = !context.state.drawerShowDetails\r\n) => {\r\n  if (context.getters.touchPlatform) {\r\n    context.state.mobileDrawerShowDetails = value\r\n  } else {\r\n    context.state.drawerShowDetails = value\r\n    context.state.drawerActivation = value\r\n  }\r\n}\r\n\r\nexport const drawersActions = {\r\n  toggleResultDrawers,\r\n}\r\n","import { Context } from \"../store.model\"\r\nimport { MapType } from \"./map.model\"\r\n\r\n/**\r\n * Updates map frame so the offset problem is no more.\r\n * @param delay - Delay time in ms before updating\r\n */\r\nconst shakeMap = (context: Context, delay = 0) => {\r\n  setTimeout(() => context.state.map?.updateSize(), delay)\r\n}\r\n\r\n/**\r\n * Switches poi layer\r\n * @param value - Whether it should be on or off\r\n */\r\nconst togglePoi = (context: Context, value = !context.state.poiLayer) => {\r\n  context.state.poiLayer = value\r\n  context.state.map?.switchPoiLayer(value)\r\n}\r\n/**\r\n * Switches traffic layer\r\n * @param value - Whether it should be on or off\r\n */\r\nconst toggleTraffic = (\r\n  context: Context,\r\n  value = !context.state.trafficLayer\r\n) => {\r\n  context.state.trafficLayer = value\r\n  context.state.map?.switchTrafficLayer(value)\r\n}\r\n\r\nconst setMapType = (context: Context, value: MapType) => {\r\n  context.state.mapType = value\r\n  context.state.map?.setMapType(value)\r\n}\r\n\r\nexport const mapActions = {\r\n  shakeMap,\r\n  togglePoi,\r\n  toggleTraffic,\r\n  setMapType,\r\n}\r\n","import { markersActions } from \"./markers/actions\"\r\nimport { dimensionsActions } from \"./dimensions/actions\"\r\nimport { overlaysActions } from \"./overlays/actions\"\r\nimport { drawersActions } from \"./drawers/actions\"\r\nimport { mapActions } from \"./map/actions\"\r\n\r\nexport const actions = {\r\n  markers: markersActions,\r\n  dimensions: dimensionsActions,\r\n  overlays: overlaysActions,\r\n  drawers: drawersActions,\r\n  map: mapActions\r\n}\r\n","// eslint-disable-next-line\r\n// @ts-nocheck\r\nimport { stateGenerator } from \"./state\"\r\nimport { getters } from \"./getters\"\r\nimport { actions } from \"./actions\"\r\n\r\nexport const storeGen = () => {\r\n  const state = stateGenerator()\r\n  const storeGetters = getters(state)\r\n  const context = {\r\n    actions,\r\n    getters: storeGetters,\r\n    state,\r\n  }\r\n\r\n  // To inject context into actions\r\n  const actionModulesKeys = Object.keys(actions)\r\n  const storeActions: any = actionModulesKeys.reduce((sa, amk) => {\r\n    const actionKeys = Object.keys(actions[amk])\r\n    const contextFreeActions = actionKeys.reduce((cfa, ak) => {\r\n      return {\r\n        ...cfa,\r\n        [ak]: (...args) => actions[amk][ak](context, ...args),\r\n      }\r\n    }, {})\r\n    return { ...sa, [amk]: contextFreeActions }\r\n  }, {})\r\n\r\n  return { state, getters: storeGetters, actions: storeActions }\r\n}\r\n","<template>\r\n  <!-- <img :src=\"require('@/assets/search-marker.png')\" /> -->\r\n  <div\r\n    ref=\"mapContainer\"\r\n    class=\"map pos-relative o-hidden\"\r\n    :class=\"{\r\n      touch: store.getters.touchPlatform\r\n    }\"\r\n    :style=\"`font-size: ${fontSize}`\"\r\n  >\r\n    <div\r\n      ref=\"popupContainer\"\r\n      class=\"map-popup-container\"\r\n      :class=\"temporaryPopupContainerClass\"\r\n      :style=\"temporaryPopupContainerStyle\"\r\n    ></div>\r\n    <div\r\n      ref=\"persistentContainer\"\r\n      class=\"map-popup-container\"\r\n      :class=\"persistentPopupContainerClass\"\r\n      :style=\"persistentPopupContainerStyle\"\r\n    ></div>\r\n    <slot\r\n      v-if=\"!hideLayers\"\r\n      name=\"layers\"\r\n      :tiles=\"filteredTiles\"\r\n      :mapType=\"store.state.mapType\"\r\n      :poi=\"store.state.poiLayer\"\r\n      :traffic=\"store.state.trafficLayer\"\r\n    >\r\n      <DesktopLayers\r\n        v-if=\"!store.getters.touchPlatform\"\r\n        :tiles=\"filteredTiles\"\r\n        :layersClass=\"desktopLayersClass\"\r\n        :layersStyle=\"desktopLayersStyle\"\r\n      />\r\n      <MobileLayers\r\n        v-else\r\n        v-model=\"mobileDrawerModel\"\r\n        :tiles=\"filteredTiles\"\r\n        :layersClass=\"mobileLayersClass\"\r\n        :layersStyle=\"mobileLayersStyle\"\r\n      ></MobileLayers>\r\n      <button\r\n        v-if=\"store.getters.touchPlatform\"\r\n        class=\"mobile-layers-button pos-absolute justify-center align-center d-flex pointer\"\r\n        @click=\"handleMobileDrawerClick\"\r\n      >\r\n        <img src=\"../assets/images/layers-outline.svg\" />\r\n      </button>\r\n    </slot>\r\n    <slot v-if=\"!hideSearchContainer\" name=\"search-container\">\r\n      <Drawer\r\n        :items=\"store.state.searchResults\"\r\n        @search=\"handleSearch\"\r\n        @result-click=\"handleResultClick\"\r\n        @result-hover=\"handleResultHover\"\r\n      />\r\n      <MobileDetailsSection\r\n        v-if=\"store.getters.touchPlatform\"\r\n        v-show=\"store.state.mobileDrawerShowDetails\"\r\n      ></MobileDetailsSection>\r\n    </slot>\r\n  </div>\r\n</template>\r\n<script lang=\"ts\">\r\ndeclare const ol: any;\r\nimport { zoomConstants, tiles, urls } from \"../parameters\";\r\nimport { sanitizeLocation, getLocation } from \"../utils\";\r\nimport { eventsMixin } from \"../mixins\";\r\nimport { createApi } from \"../apis\";\r\nimport { storeGen } from \"../store\";\r\nimport {\r\n  defineProps,\r\n  onMounted,\r\n  PropType,\r\n  ref,\r\n  watch,\r\n  defineExpose,\r\n  defineEmits,\r\n  reactive,\r\n  provide\r\n} from \"vue\";\r\nimport {\r\n  CoordsObj,\r\n  MarkersIconCallback,\r\n  MarkerHoverCallback,\r\n  HandleSearchProps\r\n} from \"./Map.model\";\r\nimport { SearchOptions } from \"../store/markers/markers.model\";\r\nimport { MapType, OlMap, ViewType } from \"../store/map/map.model\";\r\nimport { CreateApiOptions } from \"@/apis/apis.model\";\r\nexport default {\r\n  name: \"NeshanMap\"\r\n};\r\n</script>\r\n<script setup lang=\"ts\">\r\nimport DesktopLayers from \"./layers/DesktopLayers.vue\";\r\nimport MobileLayers from \"./layers/MobileLayers.vue\";\r\nimport Drawer from \"./drawer/DrawerComp.vue\";\r\nimport MobileDetailsSection from \"./MobileDetailsSection.vue\";\r\n\r\nconst props = defineProps({\r\n  /**\r\n   * کلید نقشه، گرفته شده از پلتفرم نشان\r\n   */\r\n  mapKey: {\r\n    type: String,\r\n    required: true\r\n  },\r\n  /**\r\n   * کلید سرویس‌ها برای تبدیل نقطه به آدرس (Reverse) و جستجو (search)\r\n   */\r\n  serviceKey: {\r\n    type: String,\r\n    default: \"\"\r\n  },\r\n  reverseUrl: String,\r\n  searchUrl: String,\r\n  /**\r\n   * مرکز نقشه در هنگام شروع\r\n   */\r\n  center: {\r\n    type: Object as PropType<CoordsObj>,\r\n    default: null\r\n  },\r\n  /**\r\n   * میزان زوم نقشه در هنگام شروع\r\n   */\r\n  zoom: {\r\n    type: Number,\r\n    default: zoomConstants.initialZoom\r\n  },\r\n  /**\r\n   * نمایش یا عدم نمایش نقاط\r\n   */\r\n  poi: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  /**\r\n   * نمایش یا عدم نمایش خطوط ترافیک\r\n   */\r\n  traffic: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  /**\r\n   * نوع نقشه در هنگام شروع\r\n   * <br>\r\n   * neshan\r\n  | dreamy\r\n  | dreamy-gold\r\n  | standard-night\r\n  | standard-day\r\n  | osm-bright \r\n   */\r\n  defaultType: {\r\n    type: String as PropType<MapType>,\r\n    default: \"neshan\"\r\n  },\r\n  /**\r\n   * آرایه‌ای از انواع نقشه‌هایی که می‌خواهید در لایه‌ها نمایش داده شود.\r\n   */\r\n  mapTypes: {\r\n    type: Array as PropType<MapType[]>,\r\n    default: tiles.map((tile) => tile.title)\r\n  },\r\n  /**\r\n   * تغییر کلاس بخش لایه‌ها برای حالت دستکتاپ\r\n   */\r\n  desktopLayersClass: [String, Array, Object],\r\n  /**\r\n   * تغییر کلاس بخش لایه‌ها برای حالت موبایل\r\n   */\r\n  mobileLayersClass: [String, Array, Object],\r\n  /**\r\n   * تغییر استایل بخش لایه‌ها برای حالت دستکتاپ\r\n   */\r\n  desktopLayersStyle: Object,\r\n  /**\r\n   * تغییر استایل بخش لایه‌ها برای حالت موبایل\r\n   */\r\n  mobileLayersStyle: Object,\r\n  /**\r\n   * تغییر کلاس پاپ آپ موقت (هنگامی که کاربر با موس هاور می‌کند)\r\n   */\r\n  temporaryPopupContainerClass: [String, Array, Object],\r\n  /**\r\n   * تغییر کلاس پاپ آپ دائم (هنگامی که کاربر کلیک می‌کند)\r\n   */\r\n  persistentPopupContainerClass: [String, Array, Object],\r\n  /**\r\n   * تغییر استایل پاپ آپ موقت (هنگامی که کاربر با موس هاور می‌کند)\r\n   */\r\n  temporaryPopupContainerStyle: Object,\r\n  /**\r\n   * تغییر استایل پاپ آپ دائم (هنگامی که کاربر کلیک می‌کند)\r\n   */\r\n  persistentPopupContainerStyle: Object,\r\n  /**\r\n   * عدم نمایش لایه‌ها\r\n   */\r\n  hideLayers: Boolean,\r\n  /**\r\n   * عدم نمایش بخش سرج و نتایج\r\n   */\r\n  hideSearchContainer: Boolean,\r\n  markersIconCallback: Function as PropType<MarkersIconCallback>,\r\n  markerHoverCallback: Function as PropType<MarkerHoverCallback>,\r\n  popupOnMarkerHover: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  popupOnResultHover: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  zoomOnMarkerClick: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  zoomOnResultClick: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  cluster: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  clusterThreshold: {\r\n    type: Number,\r\n    default: 18\r\n  },\r\n  reverseOnClick: {\r\n    type: Boolean,\r\n    default: true\r\n  },\r\n  scale: {\r\n    type: Number,\r\n    default: 1\r\n  },\r\n  viewType: String as PropType<ViewType>\r\n});\r\n\r\nconst store = storeGen();\r\nprovide(\"store\", store);\r\n\r\n/**\r\n * Sets the given token for api\r\n * @param token\r\n */\r\nconst setToken = (token: string, options?: CreateApiOptions) => {\r\n  store.state.api = createApi(token, options);\r\n};\r\nsetToken(props.serviceKey, {\r\n  searchUrl: props.searchUrl,\r\n  reverseUrl: props.reverseUrl\r\n});\r\n/**\r\n * Whenever service token changes,\r\n * applies it to api\r\n */\r\nwatch(\r\n  () => [props.serviceKey, props.searchUrl, props.reverseUrl],\r\n  (nv) => {\r\n    setToken(nv[0] as string, {\r\n      searchUrl: nv[1],\r\n      reverseUrl: nv[2]\r\n    });\r\n  }\r\n);\r\nconst fontSize = ref(props.scale + \"rem\");\r\n// eslint-disable-next-line vue/no-setup-props-destructure\r\nstore.state.scale = props.scale;\r\nwatch(\r\n  () => props.scale,\r\n  (nv) => {\r\n    fontSize.value = nv + \"rem\";\r\n    store.state.scale = nv;\r\n    updateNeshanBrandContainerScale();\r\n  }\r\n);\r\n\r\nlet neshanBrandContainer: HTMLDivElement;\r\nconst getNeshanBrandContainer = () => {\r\n  if (neshanBrandContainer) return neshanBrandContainer;\r\n  const allDivs = mapContainer.value\r\n    ?.querySelector(\".ol-viewport\")\r\n    ?.querySelectorAll(\"div:last-child\");\r\n  if (!allDivs) return;\r\n  neshanBrandContainer = Array.from(allDivs)[\r\n    allDivs.length - 1\r\n  ] as HTMLDivElement;\r\n  return neshanBrandContainer;\r\n};\r\n\r\nconst updateNeshanBrandContainerScale = () => {\r\n  const neshanMapContainer = getNeshanBrandContainer();\r\n  neshanMapContainer?.style.setProperty(\"scale\", \"\" + props.scale);\r\n};\r\n\r\nconst updateNeshanBrandContainerPos = () => {\r\n  const neshanMapContainer = getNeshanBrandContainer();\r\n  neshanMapContainer?.style.setProperty(\"bottom\", \"0.2em\");\r\n  neshanMapContainer?.style.setProperty(\"left\", \"0.4em\");\r\n};\r\n\r\n// eslint-disable-next-line vue/no-setup-props-destructure\r\nstore.state.viewType = props.viewType;\r\nwatch(\r\n  () => props.viewType,\r\n  (nv) => {\r\n    store.state.viewType = nv;\r\n  }\r\n);\r\n\r\nconst mobileDrawerModel = ref(false);\r\nconst filteredTiles = reactive(\r\n  tiles.filter((tile) => props.mapTypes.includes(tile.title))\r\n);\r\nstore.actions.map.toggleTraffic(props.traffic);\r\nstore.actions.map.togglePoi(props.poi);\r\nwatch(\r\n  () => props.traffic,\r\n  (nv) => {\r\n    store.actions.map.toggleTrafficLayer(nv);\r\n  }\r\n);\r\nwatch(\r\n  () => props.poi,\r\n  (nv) => {\r\n    store.actions.map.togglePoiLayer(nv);\r\n  }\r\n);\r\nconst mapContainer = ref<HTMLDivElement>();\r\n/**\r\n * Adds the map from given url to given script\r\n * @param url - Url of map or another script\r\n * @param tagName - Name of the expected tag\r\n * @returns Created tag\r\n */\r\nconst importMap = (url: string, tagName = \"my-openlayer\") => {\r\n  const foundDoc = document.getElementById(tagName);\r\n  if (foundDoc) return foundDoc; // was already loaded\r\n  const scriptTag = document.createElement(\"script\");\r\n  scriptTag.src = url;\r\n  scriptTag.id = tagName;\r\n  document.getElementsByTagName(\"head\")[0].appendChild(scriptTag);\r\n  return scriptTag;\r\n};\r\n\r\nconst sanitizedCenter = ref(\r\n  sanitizeLocation(props.center)\r\n);\r\n/**\r\n * Starts the map and adds it to element with id='map'\r\n * Gets the mapKey, zoom, traffic and poi from props.\r\n * Gets the center from either sanitizedCenter variable or gets it from divice location\r\n * or Neshan building location.\r\n */\r\nconst startMap = async () => {\r\n  if (!mapContainer.value) return;\r\n  const centralCoords = sanitizedCenter.value || (await getLocation());\r\n  const newMap: OlMap = new ol.Map({\r\n    target: mapContainer.value,\r\n    key: props.mapKey,\r\n    // mapType: 'standard-night',\r\n    poi: store.state.poiLayer,\r\n    traffic: store.state.trafficLayer,\r\n    view: new ol.View({\r\n      center: ol.proj.fromLonLat(centralCoords),\r\n      zoom: props.zoom,\r\n      smoothExtentConstraint: true\r\n      // projection: 'EPSG:4326' //Default was EPSG:3857\r\n    }),\r\n    controls: []\r\n  });\r\n  store.state.map = newMap;\r\n  store.state.map.setMapType(props.defaultType);\r\n  // Currently there is a problem with assigning different map type on initilization\r\n  store.state.mapType = props.defaultType;\r\n  store.actions.map.shakeMap(300);\r\n};\r\n\r\nconst popupContainer = ref<HTMLDivElement>();\r\nconst persistentContainer = ref<HTMLDivElement>();\r\nconst eventsEmits = defineEmits([\r\n  \"on-zoom\",\r\n  \"on-click\",\r\n  \"on-result-hover\",\r\n  \"on-result-click\"\r\n]);\r\nconst { setupMapEvents, handleResultHover, handleResultClick } = eventsMixin({\r\n  emits: eventsEmits,\r\n  store,\r\n  markerHoverCallback: props.markerHoverCallback,\r\n  markersIconCallback: props.markersIconCallback,\r\n  zoomOnMarkerClick: props.zoomOnMarkerClick,\r\n  zoomOnResultClick: props.zoomOnResultClick,\r\n  popupOnMarkerHover: props.popupOnMarkerHover,\r\n  popupOnResultHover: props.popupOnResultHover,\r\n  reverseOnClick: props.reverseOnClick\r\n});\r\n\r\n/**\r\n * Changes cluster source to marker source on cluster threshold passing and vice versa\r\n */\r\nwatch(\r\n  () => store.state.zoom,\r\n  (nv, ov) => {\r\n    if (nv >= props.clusterThreshold && ov < props.clusterThreshold) {\r\n      store.actions.markers.toggleClusterSource(\r\n        store.state.searchMarkers,\r\n        true\r\n      );\r\n    } else if (nv < props.clusterThreshold && ov >= props.clusterThreshold) {\r\n      store.actions.markers.toggleClusterSource(\r\n        store.state.searchMarkers,\r\n        false\r\n      );\r\n    }\r\n  }\r\n);\r\n\r\nconst handleSearch = ({ term, coords }: HandleSearchProps) => {\r\n  const reliableCoords =\r\n    coords || store.state.mainMarkerCoords || sanitizedCenter.value;\r\n  if (!reliableCoords || !store.state.api) return;\r\n  const options: SearchOptions = {\r\n    cluster: props.cluster,\r\n    clusterThreshold: props.clusterThreshold,\r\n    markersIconCallback: props.markersIconCallback\r\n  };\r\n  store.actions.markers.search({ term, coords: reliableCoords }, options);\r\n};\r\n\r\nconst exposingSearch = ({ term, coords }: HandleSearchProps) => {\r\n  store.state.drawerActivation = true;\r\n  handleSearch({ term, coords });\r\n};\r\n\r\nconst handleMobileDrawerClick = (event: MouseEvent) => {\r\n  const target: any = event.composedPath()[1];\r\n  target.classList.add(\"floaten\");\r\n  setTimeout(() => target.classList.remove(\"floaten\"), 350);\r\n  mobileDrawerModel.value = true;\r\n};\r\n\r\ndefineExpose({\r\n  state: store.state,\r\n  search: exposingSearch,\r\n  reverse: store.actions.markers.reverseOnPoint\r\n});\r\n\r\nconst onScriptLoad = async () => {\r\n  await startMap();\r\n  setupMapEvents();\r\n  store.actions.dimensions.updateMapDimensions();\r\n};\r\nstore.actions.dimensions.updateBreakpoints();\r\n/**\r\n * Setups Map, adds serviceToken to api\r\n */\r\nonMounted(() => {\r\n  if (mapContainer.value) store.state.mapContainer = mapContainer.value;\r\n  if (popupContainer.value) store.state.popupContainer = popupContainer.value;\r\n  if (persistentContainer.value)\r\n    store.state.persistentContainer = persistentContainer.value;\r\n  if (typeof ol !== \"undefined\") {\r\n    onScriptLoad();\r\n  } else {\r\n    const scriptTag = importMap(urls.map);\r\n    scriptTag.addEventListener(\"load\", () => {\r\n      onScriptLoad();\r\n    });\r\n  }\r\n  updateNeshanBrandContainerScale();\r\n  updateNeshanBrandContainerPos();\r\n});\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n@import url(\"@/assets/main.scss\");\r\n@import url(\"https://static.neshan.org/sdk/openlayers/5.3.0/ol.css\");\r\n.ol-overlay-container {\r\n  pointer-events: none;\r\n}\r\n</style>\r\n<style lang=\"scss\" scoped>\r\n@import url(\"./Map.scss\");\r\n</style>\r\n"],"names":["_imports_0$1","_imports_0","_imports_1","store","inject","instance","getCurrentInstance","updateModel","value","emit","showTiles","ref","watch","props","newValue","_a","close","inlineSvgs","computedSize","computed","urls","markerUrls","tiles","breakpointsSegments","breakpointsSegmentsPixels","drawerConstants","unsetMapDimnensions","zoomConstants","markersOffset","width","text","val","runTimeout","emitSearch","term","inputText","emitTimeout","delay","getTitleFromData","data","mainTitle","sanitizeLocation","loc","getLocation","position","resolve","pos","createCoordsObject","transformCoords","point","from","to","createMarkers","points","options","iconScale","features","createFeaturesFromPoints","layer","_style","createClusterLayer","styleFunc","style","createStyle","source","createSource","createLayer","createIcon","src","anchor","createRawStyle","image","hidePopup","styleFuncGen","target","createMapPoints","items","item","mapPoint","iconUrl","checkIconImageExistance","iconName","searchUrl","exists","urlExists","url","status","feature","iconProps","rawCreateIconProps","createIconProps","createClusterSource","minDistance","distance","createClusterText","size","createClusterCircle","createClusterStyle","createClusterStyleFunc","styleCache","clusterFeature","innerFeatures","feat","getClusterExtent","cluster","originalFeatures","extent","f","getFeatureExtent","getCoordsAndTextFromFeature","featCoords","getCoordsFromFeature","featText","markersIconCallback","isTouchPlatform","check","a","eventsMixin","emits","markerHoverCallback","zoomOnMarkerClick","zoomOnResultClick","popupOnMarkerHover","popupOnResultHover","reverseOnClick","setupMapEvents","setupClickEvent","setupZoomEvent","setupMarkerHoverEvent","setupResizeEvents","event","handleClickEvent","newZoom","evt","hoveredFeature","isMainMarker","emittingMarker","emittingData","coords","selectedFeature","handleFeatureClick","result","clusterResult","detailsSectionMixin","containerRef","formattedItem","isReverse","region","dimensionsMixin","nv","updateWidth","initialWidth","onUpdated","nextTick","pointDetailsContainer","resultSection","handleHoverEmit","emitHover","emitClick","searchText","searchData","emitResultClick","emitResultHover","mapDrawer","searchSection","toggleDrawerMaxDimenstions","activated","height","onMounted","mobileDetailsSectionContainer","detailsContainer","fullScreen","detailsContainerMaxHeight","detailsContainerBorderRadius","detailsContainerTransition","handleTouchMove","additionalHeight","handleTouchEnd","addTemporaryTransition","maxHeight","currentHeight","mapHeight","closeScreen","timeout","transitionTime","hideModal","collapseSheet","openSheet","createHeaders","token","createApi","requestOptions","reverseReqOptions","searchReqOptions","lng","lat","params","stateGen","dimenstionsState","markersState","overlayState","drawersState","mapState","state","stateGenerator","reactive","getters","addMarkers","toggleClusterSource","context","deactivate","clusterFeatures","cf","newDistance","newSource","getClusterByCoords","clusters","foundFeature","getMarkerInClusterByCoords","getMarkerByCoords","getSearchResultByFeature","title","si","zoomToLayer","zoomToExtent","duration","zoomToMarker","marker","zoomToCluster","zoomToCoords","selectFeauture","foundResult","deselectAll","getFeatureFromEvent","reverseOnPoint","useMarker","usePopup","customText","mapCoords","extendedData","error","search","resultsWithMapCoords","markersActions","updateMapDimensions","updateBreakpoints","keys","newBreakpoints","toRaw","brp","i","nextBrp","dimensionsActions","setupOverlays","overlay","createOverlay","persistentOverlay","_b","changeOverlayStats","stats","targetContainer","targetOverlay","offset","container","persistent","overlaysActions","toggleResultDrawers","drawersActions","shakeMap","togglePoi","toggleTraffic","setMapType","mapActions","actions","storeGen","storeGetters","storeActions","sa","amk","contextFreeActions","cfa","ak","args","__default__","provide","setToken","fontSize","updateNeshanBrandContainerScale","neshanBrandContainer","getNeshanBrandContainer","allDivs","mapContainer","neshanMapContainer","updateNeshanBrandContainerPos","mobileDrawerModel","filteredTiles","tile","importMap","tagName","foundDoc","scriptTag","sanitizedCenter","startMap","centralCoords","newMap","popupContainer","persistentContainer","handleResultHover","handleResultClick","eventsEmits","ov","handleSearch","reliableCoords","exposingSearch","handleMobileDrawerClick","expose","onScriptLoad"],"mappings":"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"}